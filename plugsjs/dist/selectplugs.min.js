!function($){var pluginName="selectArea",defaults={backdatainfo:function(){}},SelectArea=function(a,b){this.$ele=$(a),this.options=$.extend({},defaults,b),this.init()};SelectArea.prototype={$areas:'[{"d":"110000","p":"北京市","n":1,"c":[{"a":"110100","b":"北京市","c":"110000"}]},{"d":"120000","p":"天津市","n":1,"c":[{"a":"120100","b":"天津市","c":"120000"}]},{"d":"130000","p":"河北省","n":11,"c":[{"a":"130100","b":"石家庄市","c":"130000"},{"a":"130200","b":"唐山市","c":"130000"},{"a":"130300","b":"秦皇岛市","c":"130000"},{"a":"130400","b":"邯郸市","c":"130000"},{"a":"130500","b":"邢台市","c":"130000"},{"a":"130600","b":"保定市","c":"130000"},{"a":"130700","b":"张家口市","c":"130000"},{"a":"130800","b":"承德市","c":"130000"},{"a":"130900","b":"沧州市","c":"130000"},{"a":"131000","b":"廊坊市","c":"130000"},{"a":"131100","b":"衡水市","c":"130000"}]},{"d":"140000","p":"山西省","n":11,"c":[{"a":"140100","b":"太原市","c":"140000"},{"a":"140200","b":"大同市","c":"140000"},{"a":"140300","b":"阳泉市","c":"140000"},{"a":"140400","b":"长治市","c":"140000"},{"a":"140500","b":"晋城市","c":"140000"},{"a":"140600","b":"朔州市","c":"140000"},{"a":"140700","b":"晋中市","c":"140000"},{"a":"140800","b":"运城市","c":"140000"},{"a":"140900","b":"忻州市","c":"140000"},{"a":"141000","b":"临汾市","c":"140000"},{"a":"141100","b":"吕梁市","c":"140000"}]},{"d":"150000","p":"内蒙古自治区","n":12,"c":[{"a":"150100","b":"呼和浩特市","c":"150000"},{"a":"150200","b":"包头市","c":"150000"},{"a":"150300","b":"乌海市","c":"150000"},{"a":"150400","b":"赤峰市","c":"150000"},{"a":"150500","b":"通辽市","c":"150000"},{"a":"150600","b":"鄂尔多斯市","c":"150000"},{"a":"150700","b":"呼伦贝尔市","c":"150000"},{"a":"150800","b":"巴彦淖尔市","c":"150000"},{"a":"150900","b":"乌兰察布市","c":"150000"},{"a":"152200","b":"兴安盟","c":"150000"},{"a":"152500","b":"锡林郭勒盟","c":"150000"},{"a":"152900","b":"阿拉善盟","c":"150000"}]},{"d":"210000","p":"辽宁省","n":14,"c":[{"a":"210100","b":"沈阳市","c":"210000"},{"a":"210200","b":"大连市","c":"210000"},{"a":"210300","b":"鞍山市","c":"210000"},{"a":"210400","b":"抚顺市","c":"210000"},{"a":"210500","b":"本溪市","c":"210000"},{"a":"210600","b":"丹东市","c":"210000"},{"a":"210700","b":"锦州市","c":"210000"},{"a":"210800","b":"营口市","c":"210000"},{"a":"210900","b":"阜新市","c":"210000"},{"a":"211000","b":"辽阳市","c":"210000"},{"a":"211100","b":"盘锦市","c":"210000"},{"a":"211200","b":"铁岭市","c":"210000"},{"a":"211300","b":"朝阳市","c":"210000"},{"a":"211400","b":"葫芦岛市","c":"210000"}]},{"d":"220000","p":"吉林省","n":9,"c":[{"a":"220100","b":"长春市","c":"220000"},{"a":"220200","b":"吉林市","c":"220000"},{"a":"220300","b":"四平市","c":"220000"},{"a":"220400","b":"辽源市","c":"220000"},{"a":"220500","b":"通化市","c":"220000"},{"a":"220600","b":"白山市","c":"220000"},{"a":"220700","b":"松原市","c":"220000"},{"a":"220800","b":"白城市","c":"220000"},{"a":"222400","b":"延边朝鲜族自治州","c":"220000"}]},{"d":"230000","p":"黑龙江省","n":13,"c":[{"a":"230100","b":"哈尔滨市","c":"230000"},{"a":"230200","b":"齐齐哈尔市","c":"230000"},{"a":"230300","b":"鸡西市","c":"230000"},{"a":"230400","b":"鹤岗市","c":"230000"},{"a":"230500","b":"双鸭山市","c":"230000"},{"a":"230600","b":"大庆市","c":"230000"},{"a":"230700","b":"伊春市","c":"230000"},{"a":"230800","b":"佳木斯市","c":"230000"},{"a":"230900","b":"七台河市","c":"230000"},{"a":"231000","b":"牡丹江市","c":"230000"},{"a":"231100","b":"黑河市","c":"230000"},{"a":"231200","b":"绥化市","c":"230000"},{"a":"232700","b":"大兴安岭地区","c":"230000"}]},{"d":"310000","p":"上海市","n":1,"c":[{"a":"310100","b":"上海市","c":"310000"}]},{"d":"320000","p":"江苏省","n":13,"c":[{"a":"320100","b":"南京市","c":"320000"},{"a":"320200","b":"无锡市","c":"320000"},{"a":"320300","b":"徐州市","c":"320000"},{"a":"320400","b":"常州市","c":"320000"},{"a":"320500","b":"苏州市","c":"320000"},{"a":"320600","b":"南通市","c":"320000"},{"a":"320700","b":"连云港市","c":"320000"},{"a":"320800","b":"淮安市","c":"320000"},{"a":"320900","b":"盐城市","c":"320000"},{"a":"321000","b":"扬州市","c":"320000"},{"a":"321100","b":"镇江市","c":"320000"},{"a":"321200","b":"泰州市","c":"320000"},{"a":"321300","b":"宿迁市","c":"320000"}]},{"d":"330000","p":"浙江省","n":11,"c":[{"a":"330100","b":"杭州市","c":"330000"},{"a":"330200","b":"宁波市","c":"330000"},{"a":"330300","b":"温州市","c":"330000"},{"a":"330400","b":"嘉兴市","c":"330000"},{"a":"330500","b":"湖州市","c":"330000"},{"a":"330600","b":"绍兴市","c":"330000"},{"a":"330700","b":"金华市","c":"330000"},{"a":"330800","b":"衢州市","c":"330000"},{"a":"330900","b":"舟山市","c":"330000"},{"a":"331000","b":"台州市","c":"330000"},{"a":"331100","b":"丽水市","c":"330000"}]},{"d":"340000","p":"安徽省","n":17,"c":[{"a":"340100","b":"合肥市","c":"340000"},{"a":"340200","b":"芜湖市","c":"340000"},{"a":"340300","b":"蚌埠市","c":"340000"},{"a":"340400","b":"淮南市","c":"340000"},{"a":"340500","b":"马鞍山市","c":"340000"},{"a":"340600","b":"淮北市","c":"340000"},{"a":"340700","b":"铜陵市","c":"340000"},{"a":"340800","b":"安庆市","c":"340000"},{"a":"341000","b":"黄山市","c":"340000"},{"a":"341100","b":"滁州市","c":"340000"},{"a":"341200","b":"阜阳市","c":"340000"},{"a":"341300","b":"宿州市","c":"340000"},{"a":"341400","b":"巢湖市","c":"340000"},{"a":"341500","b":"六安市","c":"340000"},{"a":"341600","b":"亳州市","c":"340000"},{"a":"341700","b":"池州市","c":"340000"},{"a":"341800","b":"宣城市","c":"340000"}]},{"d":"350000","p":"福建省","n":9,"c":[{"a":"350100","b":"福州市","c":"350000"},{"a":"350200","b":"厦门市","c":"350000"},{"a":"350300","b":"莆田市","c":"350000"},{"a":"350400","b":"三明市","c":"350000"},{"a":"350500","b":"泉州市","c":"350000"},{"a":"350600","b":"漳州市","c":"350000"},{"a":"350700","b":"南平市","c":"350000"},{"a":"350800","b":"龙岩市","c":"350000"},{"a":"350900","b":"宁德市","c":"350000"}]},{"d":"360000","p":"江西省","n":11,"c":[{"a":"360100","b":"南昌市","c":"360000"},{"a":"360200","b":"景德镇市","c":"360000"},{"a":"360300","b":"萍乡市","c":"360000"},{"a":"360400","b":"九江市","c":"360000"},{"a":"360500","b":"新余市","c":"360000"},{"a":"360600","b":"鹰潭市","c":"360000"},{"a":"360700","b":"赣州市","c":"360000"},{"a":"360800","b":"吉安市","c":"360000"},{"a":"360900","b":"宜春市","c":"360000"},{"a":"361000","b":"抚州市","c":"360000"},{"a":"361100","b":"上饶市","c":"360000"}]},{"d":"370000","p":"山东省","n":17,"c":[{"a":"370100","b":"济南市","c":"370000"},{"a":"370200","b":"青岛市","c":"370000"},{"a":"370300","b":"淄博市","c":"370000"},{"a":"370400","b":"枣庄市","c":"370000"},{"a":"370500","b":"东营市","c":"370000"},{"a":"370600","b":"烟台市","c":"370000"},{"a":"370700","b":"潍坊市","c":"370000"},{"a":"370800","b":"济宁市","c":"370000"},{"a":"370900","b":"泰安市","c":"370000"},{"a":"371000","b":"威海市","c":"370000"},{"a":"371100","b":"日照市","c":"370000"},{"a":"371200","b":"莱芜市","c":"370000"},{"a":"371300","b":"临沂市","c":"370000"},{"a":"371400","b":"德州市","c":"370000"},{"a":"371500","b":"聊城市","c":"370000"},{"a":"371600","b":"滨州市","c":"370000"},{"a":"371700","b":"荷泽市","c":"370000"}]},{"d":"410000","p":"河南省","n":17,"c":[{"a":"410100","b":"郑州市","c":"410000"},{"a":"410200","b":"开封市","c":"410000"},{"a":"410300","b":"洛阳市","c":"410000"},{"a":"410400","b":"平顶山市","c":"410000"},{"a":"410500","b":"安阳市","c":"410000"},{"a":"410600","b":"鹤壁市","c":"410000"},{"a":"410700","b":"新乡市","c":"410000"},{"a":"410800","b":"焦作市","c":"410000"},{"a":"410900","b":"濮阳市","c":"410000"},{"a":"411000","b":"许昌市","c":"410000"},{"a":"411100","b":"漯河市","c":"410000"},{"a":"411200","b":"三门峡市","c":"410000"},{"a":"411300","b":"南阳市","c":"410000"},{"a":"411400","b":"商丘市","c":"410000"},{"a":"411500","b":"信阳市","c":"410000"},{"a":"411600","b":"周口市","c":"410000"},{"a":"411700","b":"驻马店市","c":"410000"}]},{"d":"420000","p":"湖北省","n":14,"c":[{"a":"420100","b":"武汉市","c":"420000"},{"a":"420200","b":"黄石市","c":"420000"},{"a":"420300","b":"十堰市","c":"420000"},{"a":"420500","b":"宜昌市","c":"420000"},{"a":"420600","b":"襄樊市","c":"420000"},{"a":"420700","b":"鄂州市","c":"420000"},{"a":"420800","b":"荆门市","c":"420000"},{"a":"420900","b":"孝感市","c":"420000"},{"a":"421000","b":"荆州市","c":"420000"},{"a":"421100","b":"黄冈市","c":"420000"},{"a":"421200","b":"咸宁市","c":"420000"},{"a":"421300","b":"随州市","c":"420000"},{"a":"422800","b":"恩施土家族苗族自治州","c":"420000"},{"a":"429000","b":"省直辖行政单位","c":"420000"}]},{"d":"430000","p":"湖南省","n":14,"c":[{"a":"430100","b":"长沙市","c":"430000"},{"a":"430200","b":"株洲市","c":"430000"},{"a":"430300","b":"湘潭市","c":"430000"},{"a":"430400","b":"衡阳市","c":"430000"},{"a":"430500","b":"邵阳市","c":"430000"},{"a":"430600","b":"岳阳市","c":"430000"},{"a":"430700","b":"常德市","c":"430000"},{"a":"430800","b":"张家界市","c":"430000"},{"a":"430900","b":"益阳市","c":"430000"},{"a":"431000","b":"郴州市","c":"430000"},{"a":"431100","b":"永州市","c":"430000"},{"a":"431200","b":"怀化市","c":"430000"},{"a":"431300","b":"娄底市","c":"430000"},{"a":"433100","b":"湘西土家族苗族自治州","c":"430000"}]},{"d":"440000","p":"广东省","n":21,"c":[{"a":"440100","b":"广州市","c":"440000"},{"a":"440200","b":"韶关市","c":"440000"},{"a":"440300","b":"深圳市","c":"440000"},{"a":"440400","b":"珠海市","c":"440000"},{"a":"440500","b":"汕头市","c":"440000"},{"a":"440600","b":"佛山市","c":"440000"},{"a":"440700","b":"江门市","c":"440000"},{"a":"440800","b":"湛江市","c":"440000"},{"a":"440900","b":"茂名市","c":"440000"},{"a":"441200","b":"肇庆市","c":"440000"},{"a":"441300","b":"惠州市","c":"440000"},{"a":"441400","b":"梅州市","c":"440000"},{"a":"441500","b":"汕尾市","c":"440000"},{"a":"441600","b":"河源市","c":"440000"},{"a":"441700","b":"阳江市","c":"440000"},{"a":"441800","b":"清远市","c":"440000"},{"a":"441900","b":"东莞市","c":"440000"},{"a":"442000","b":"中山市","c":"440000"},{"a":"445100","b":"潮州市","c":"440000"},{"a":"445200","b":"揭阳市","c":"440000"},{"a":"445300","b":"云浮市","c":"440000"}]},{"d":"450000","p":"广西壮族自治区","n":14,"c":[{"a":"450100","b":"南宁市","c":"450000"},{"a":"450200","b":"柳州市","c":"450000"},{"a":"450300","b":"桂林市","c":"450000"},{"a":"450400","b":"梧州市","c":"450000"},{"a":"450500","b":"北海市","c":"450000"},{"a":"450600","b":"防城港市","c":"450000"},{"a":"450700","b":"钦州市","c":"450000"},{"a":"450800","b":"贵港市","c":"450000"},{"a":"450900","b":"玉林市","c":"450000"},{"a":"451000","b":"百色市","c":"450000"},{"a":"451100","b":"贺州市","c":"450000"},{"a":"451200","b":"河池市","c":"450000"},{"a":"451300","b":"来宾市","c":"450000"},{"a":"451400","b":"崇左市","c":"450000"}]},{"d":"460000","p":"海南省","n":3,"c":[{"a":"460100","b":"海口市","c":"460000"},{"a":"460200","b":"三亚市","c":"460000"},{"a":"469000","b":"省直辖县级行政单位","c":"460000"}]},{"d":"500000","p":"重庆市","n":1,"c":[{"a":"500100","b":"重庆市","c":"500000"}]},{"d":"510000","p":"四川省","n":21,"c":[{"a":"510100","b":"成都市","c":"510000"},{"a":"510300","b":"自贡市","c":"510000"},{"a":"510400","b":"攀枝花市","c":"510000"},{"a":"510500","b":"泸州市","c":"510000"},{"a":"510600","b":"德阳市","c":"510000"},{"a":"510700","b":"绵阳市","c":"510000"},{"a":"510800","b":"广元市","c":"510000"},{"a":"510900","b":"遂宁市","c":"510000"},{"a":"511000","b":"内江市","c":"510000"},{"a":"511100","b":"乐山市","c":"510000"},{"a":"511300","b":"南充市","c":"510000"},{"a":"511400","b":"眉山市","c":"510000"},{"a":"511500","b":"宜宾市","c":"510000"},{"a":"511600","b":"广安市","c":"510000"},{"a":"511700","b":"达州市","c":"510000"},{"a":"511800","b":"雅安市","c":"510000"},{"a":"511900","b":"巴中市","c":"510000"},{"a":"512000","b":"资阳市","c":"510000"},{"a":"513200","b":"阿坝藏族羌族自治州","c":"510000"},{"a":"513300","b":"甘孜藏族自治州","c":"510000"},{"a":"513400","b":"凉山彝族自治州","c":"510000"}]},{"d":"520000","p":"贵州省","n":9,"c":[{"a":"520100","b":"贵阳市","c":"520000"},{"a":"520200","b":"六盘水市","c":"520000"},{"a":"520300","b":"遵义市","c":"520000"},{"a":"520400","b":"安顺市","c":"520000"},{"a":"522200","b":"铜仁地区","c":"520000"},{"a":"522300","b":"黔西南布依族苗族自治州","c":"520000"},{"a":"522400","b":"毕节地区","c":"520000"},{"a":"522600","b":"黔东南苗族侗族自治州","c":"520000"},{"a":"522700","b":"黔南布依族苗族自治州","c":"520000"}]},{"d":"530000","p":"云南省","n":16,"c":[{"a":"530100","b":"昆明市","c":"530000"},{"a":"530300","b":"曲靖市","c":"530000"},{"a":"530400","b":"玉溪市","c":"530000"},{"a":"530500","b":"保山市","c":"530000"},{"a":"530600","b":"昭通市","c":"530000"},{"a":"530700","b":"丽江市","c":"530000"},{"a":"530800","b":"思茅市","c":"530000"},{"a":"530900","b":"临沧市","c":"530000"},{"a":"532300","b":"楚雄彝族自治州","c":"530000"},{"a":"532500","b":"红河哈尼族彝族自治州","c":"530000"},{"a":"532600","b":"文山壮族苗族自治州","c":"530000"},{"a":"532800","b":"西双版纳傣族自治州","c":"530000"},{"a":"532900","b":"大理白族自治州","c":"530000"},{"a":"533100","b":"德宏傣族景颇族自治州","c":"530000"},{"a":"533300","b":"怒江傈僳族自治州","c":"530000"},{"a":"533400","b":"迪庆藏族自治州","c":"530000"}]},{"d":"540000","p":"西藏自治区","n":7,"c":[{"a":"540100","b":"拉萨市","c":"540000"},{"a":"542100","b":"昌都地区","c":"540000"},{"a":"542200","b":"山南地区","c":"540000"},{"a":"542300","b":"日喀则地区","c":"540000"},{"a":"542400","b":"那曲地区","c":"540000"},{"a":"542500","b":"阿里地区","c":"540000"},{"a":"542600","b":"林芝地区","c":"540000"}]},{"d":"610000","p":"陕西省","n":10,"c":[{"a":"610100","b":"西安市","c":"610000"},{"a":"610200","b":"铜川市","c":"610000"},{"a":"610300","b":"宝鸡市","c":"610000"},{"a":"610400","b":"咸阳市","c":"610000"},{"a":"610500","b":"渭南市","c":"610000"},{"a":"610600","b":"延安市","c":"610000"},{"a":"610700","b":"汉中市","c":"610000"},{"a":"610800","b":"榆林市","c":"610000"},{"a":"610900","b":"安康市","c":"610000"},{"a":"611000","b":"商洛市","c":"610000"}]},{"d":"620000","p":"甘肃省","n":14,"c":[{"a":"620100","b":"兰州市","c":"620000"},{"a":"620200","b":"嘉峪关市","c":"620000"},{"a":"620300","b":"金昌市","c":"620000"},{"a":"620400","b":"白银市","c":"620000"},{"a":"620500","b":"天水市","c":"620000"},{"a":"620600","b":"武威市","c":"620000"},{"a":"620700","b":"张掖市","c":"620000"},{"a":"620800","b":"平凉市","c":"620000"},{"a":"620900","b":"酒泉市","c":"620000"},{"a":"621000","b":"庆阳市","c":"620000"},{"a":"621100","b":"定西市","c":"620000"},{"a":"621200","b":"陇南市","c":"620000"},{"a":"622900","b":"临夏回族自治州","c":"620000"},{"a":"623000","b":"甘南藏族自治州","c":"620000"}]},{"d":"630000","p":"青海省","n":8,"c":[{"a":"630100","b":"西宁市","c":"630000"},{"a":"632100","b":"海东地区","c":"630000"},{"a":"632200","b":"海北藏族自治州","c":"630000"},{"a":"632300","b":"黄南藏族自治州","c":"630000"},{"a":"632500","b":"海南藏族自治州","c":"630000"},{"a":"632600","b":"果洛藏族自治州","c":"630000"},{"a":"632700","b":"玉树藏族自治州","c":"630000"},{"a":"632800","b":"海西蒙古族藏族自治州","c":"630000"}]},{"d":"640000","p":"宁夏回族自治区","n":5,"c":[{"a":"640100","b":"银川市","c":"640000"},{"a":"640200","b":"石嘴山市","c":"640000"},{"a":"640300","b":"吴忠市","c":"640000"},{"a":"640400","b":"固原市","c":"640000"},{"a":"640500","b":"中卫市","c":"640000"}]},{"d":"650000","p":"新疆维吾尔自治区","n":15,"c":[{"a":"650100","b":"乌鲁木齐市","c":"650000"},{"a":"650200","b":"克拉玛依市","c":"650000"},{"a":"652100","b":"吐鲁番地区","c":"650000"},{"a":"652200","b":"哈密地区","c":"650000"},{"a":"652300","b":"昌吉回族自治州","c":"650000"},{"a":"652700","b":"博尔塔拉蒙古自治州","c":"650000"},{"a":"652800","b":"巴音郭楞蒙古自治州","c":"650000"},{"a":"652900","b":"阿克苏地区","c":"650000"},{"a":"653000","b":"克孜勒苏柯尔克孜自治州","c":"650000"},{"a":"653100","b":"喀什地区","c":"650000"},{"a":"653200","b":"和田地区","c":"650000"},{"a":"654000","b":"伊犁哈萨克自治州","c":"650000"},{"a":"654200","b":"塔城地区","c":"650000"},{"a":"654300","b":"阿勒泰地区","c":"650000"},{"a":"659000","b":"省直辖行政单位","c":"650000"}]},{"d":"710000","p":"台湾省","n":0,"c":""},{"d":"810000","p":"香港特别行政区","n":0,"c":""},{"d":"820000","p":"澳门特别行政区","n":0,"c":""},{"d":"1000000","p":"其他","n":1,"c":[{"a":"659001","b":"其他","c":"1000000"}]}] ',init:function(){return this.create().bindEvent(),this},create:function(){var a=this,b=[];b[0]='<div id="myAreaModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button><h3>选择地区</h3></div><div class="modal-body"><div class="pdata"></div><div class="previewarea"><div>已选择区域：</div><ul class="scrollbar"></ul></div></div><div class="modal-footer"><button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button><button class="btn btn-primary" id="areasubmit">确定</button></div></div>';var c=$("body").find("#myAreaModal").length;return 0>=c&&$(document.body).append(b[0]),a.$modalHTML=$("body").find("#myAreaModal"),a.showJsonPc(),this},showJsonPc:function(){var _this=this,dataObj=eval("("+_this.$areas+")"),p_datas="";$.each(dataObj,function(a,b){for(area_d=b.d,area_p=b.p,area_n=b.n,area_c=b.c,c_datas="",j=0;j<area_c.length;j++)c_a=area_c[j].a,c_b=area_c[j].b,c_c=area_c[j].c,c_datas+="<span class='areacity'><input type='checkbox' value='"+c_a+"' id='J_City_"+c_a+"' class='J_city' aname='"+c_b+"' ><label for='J_City_"+c_a+"' >"+c_b+"</label></span>";p_datas+="<div class='ecitys'><span class='s_province'><input type='checkbox' aname='"+area_p+"'  value='"+area_d+"' id='J_Province_"+area_d+"' class='J_Province' ><label for='J_Province_"+area_d+"' >"+area_p+"</label><span class='check_num'></span>",c_datas&&(p_datas+="<a href='javascript:void(0)' title='点击选择城市' class='select_city'>↓</a>"),p_datas+="</span>",c_datas&&(p_datas+="<div class='pcitys'>"+c_datas+"<div class='btn_closecity'><span class='btn btn-small' title='关闭'>关闭</span></div></div>"),p_datas+="</div>"}),$("#myAreaModal .pdata").html(p_datas)},show:function(){return this.$modalHTML.modal("show"),this},hide:function(){return this.$modalHTML.modal("hide"),this},bindEvent:function(){var a=this,b=a.$ele;$("#myAreaModal .s_province").undelegate(),$("#myAreaModal .s_province").delegate(".J_Province","change",function(){var a=$(this).parent().next(".pcitys"),b=a.find("input").length,c=$(this).attr("aname"),d=$(this).attr("value");if("checked"==$(this).attr("checked")){$(this).parent().find(".check_num").html("("+b+")").show(),a.find("input").attr("checked",!0),$(this).parent().next().find(".J_city").each(function(){var a=$(this).attr("value");$(".previewarea").find("li").each(function(){var b=$(this).attr("rel");a==b&&$(".previewarea").find("#p"+b).remove()})});var e="<li rel='"+d+"' id='p"+d+"' aname='"+c+"' type='p'>"+c+"<span class='canclearea'>×</span></li>";$(".previewarea").find("ul").append(e)}else $(this).parent().find(".check_num").html("(0)").hide(),a.find("input").attr("checked",!1),a.hide(),$(".previewarea").find("li").each(function(){var a=$(this).attr("rel");d==a&&$(".previewarea").find("#p"+a).remove()})}),$("#myAreaModal .s_province").delegate(".select_city","click",function(){var a=$(this).parent(),b=a.next(".pcitys");a.toggleClass("pupp"),b.toggle(),a.parent().siblings().find(".pcitys").hide(),a.parent().siblings().find(".s_province").removeClass("pupp")}),$(".btn_closecity .btn").live("click",function(){$(this).parents(".pcitys").hide(),$(this).parents(".pcitys").prev().removeClass("pupp")}),$("#myAreaModal .areacity").undelegate(),$("#myAreaModal .areacity").delegate("input","click",function(){var a=$(this),b=$(this).parents(".pcitys");citylen=b.find(".areacity").length,lencity_ckd=b.find(":checked").length,$(this).parents(".pcitys").prev(".s_province").find(".check_num").html("("+lencity_ckd+")").show();var c=$(this).parents(".pcitys").prev(".s_province").find("input:checkbox");if("checked"==$(this).attr("checked"))if(lencity_ckd==citylen){c.attr("checked",!0),$(".previewarea").find("li").each(function(){var b=$(this).attr("rel");a.parents(".pcitys").find(".J_city").each(function(){var a=$(this).attr("value");a==b&&$(".previewarea").find("#p"+a).remove()})});var d=c.attr("aname"),e=c.attr("value"),f="<li rel='"+e+"' id='p"+e+"' aname='"+d+"'  type='c'>"+d+"<span class='canclearea'>x</span></li>";$(".previewarea").find("ul").append(f)}else{var d=a.attr("aname"),e=a.attr("value"),f="<li rel='"+e+"' id='p"+e+"' aname='"+d+"' type='c'>"+d+"<span class='canclearea'>x</span></li>";$(".previewarea").find("ul").append(f)}else if(parseInt(lencity_ckd)+1==parseInt(citylen)){c.attr("checked",!1);var d=c.attr("aname"),e=c.attr("value");$(".previewarea").find("li").each(function(){var a=$(this).attr("rel"),b=c.attr("value");b==a&&$(".previewarea").find("#p"+b).remove()}),a.parent().siblings(".areacity").each(function(){var a=$(this).find("input").attr("aname"),b=$(this).find("input").attr("value"),c="<li rel='"+b+"' id='p"+b+"' aname='"+a+"' type='c'>"+a+"<span class='canclearea'>x</span></li>";$(".previewarea").find("ul").append(c)})}else $(".previewarea").find("li").each(function(){var b=$(this).attr("rel"),c=a.attr("value");c==b&&$(".previewarea").find("#p"+c).remove()})}),$("#myAreaModal .canclearea").live("click",function(){$(this).parent().remove();var a=$(this).parent().attr("rel");$("#myAreaModal .pdata").find("input").each(function(){var b=$(this).attr("value");if(b==a){var c=$("#myAreaModal .pdata").find("input[value='"+a+"']");if(c.attr("checked",!1),c.hasClass("J_Province"))c.parent(".s_province").find(".check_num").html("(0)").hide();else{var d=c.parents(".pcitys").find(":checked").length;c.parents(".pcitys").prev().find(".check_num").html("("+d+")"),0==d&&c.parents(".pcitys").prev().find(".check_num").hide()}}})}),$.isFunction(a.options.backdatainfo)&&($("#myAreaModal .modal-footer").undelegate(),$("#myAreaModal .modal-footer").delegate("#areasubmit","click",function(){var c=$("#myAreaModal .previewarea ul").find("li"),d=c.length;if(d>0){var e=[],f="";c.each(function(a){var b=$(this).attr("type"),c=$(this).attr("rel"),d=$(this).attr("aname"),g={id:c,type:b,name:d};e.push(g),f+=c+","}),a.options.backdatainfo(b,e),a.hide()}}))}};var old=$.fn[pluginName];$.fn[pluginName]=function(a){return this.each(function(){var b=$(this),c=b.data("selectPlugsData"),d=$.fn[pluginName].pluginData[c],e="object"==typeof a&&a;d||(c=$.fn[pluginName].pluginData.index++,$.fn[pluginName].pluginData[c]=new SelectArea(this,e),b.data("selectPlugsData",c),d=$.fn[pluginName].pluginData[c]),d.show()})},$.fn[pluginName].pluginData={index:0},$.fn[pluginName].Constructor=pluginName,$.fn[pluginName].noConflict=function(){return $.fn[pluginName]=old,this},$(document).ready(function(){$('[data-plug="'+pluginName+'"]').each(function(){var a=$(this),b=this.dataset;$.fn[pluginName].call(a,b)})}),SelectArea.version="1.0.0"}($);
!function(a){var b="selectPrds",c={host:"",sale:"1",num:0,notEle:[],alltag:["presell","fans_special","commonactivity","full_postage","fullreduced","fullgift","groupbuy","zcset","prd_card","coupon","credit_cash","credit_exchange","virtual","guid"],hasonsale:1,community_id:"",storeid:"",is_virtual:"",prdids:"",backdatainfo:function(){}},d=function(b,d){this.$ele=a(b),this.options=a.extend({},c,d),this.init()};d.prototype={$act_title:{presell:"预售",fans_special:"粉丝特价",commonactivity:"微团购",full_postage:"满多少元包邮",fullreduced:"满减现金",fullgift:"满赠",groupbuy:"组团购",zcset:"众筹",prd_card:"功能卡",coupon:"优惠券",credit_cash:credit_mark+"抵现",credit_exchange:credit_mark+"换购",wsq:"微社区",virtual:"虚拟",guid:"流程引导"},$platform:2,$onsale:1,initDom:function(){return this.$total="",this.$totalPage="",this.$curPage=1,this.$listdata_obj="",this.$listdata_arr=[],this.$postUrl=this.options.host+"/index.php/shangjia/commoncomponent/getallprd?platform="+this.$platform+"&storeid="+this.options.storeid+"&is_virtual="+this.options.is_virtual,this.$itemList=this.options.host+"/index.php/shangjia/commoncomponent/getcatslist?platform="+this.$platform+"&storeid="+this.options.storeid+"&is_virtual="+this.options.is_virtual,this.$classifyprd=this.options.host+"/index.php/shangjia/commoncomponent/getclassifyprd?platform="+this.$platform+"&storeid="+this.options.storeid+"&is_virtual="+this.options.is_virtual,this.$getactprd=this.options.host+"/index.php/shangjia/commoncomponent/getallprdactinfo?platform="+this.$platform,this.$getscoreprd=this.options.host+"/index.php/shangjia/commoncomponent/getscorechangeprds?platform="+this.$platform,this.$getprdbyids=this.options.host+"/index.php/shangjia/commoncomponent/getprddetailinfo",this},init:function(){var a=/^\d+$/.test(this.options.num);return a?(this.initDom().create(),this):(alert("请填写正确的选择数量的参数"),!1)},create:function(){var b=this,c=[];c[0]='<div id="myPrdModal" class="modal hide fade" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button> <h3>选择商品</h3><div class="mod-searchprd">'+(b.options.storeid?"":'<input type="text"  placeholder="商品标题" name="prd_k" class="prd_k"/><button class="btn j-search">查询</button>')+'<select name="list" id="sale_status" style="margin:0 0 0 10px;width:150px;"><option value="1" selected = "selected">上架商品</option><option value="2" >下架商品</option><option value="3">不限</option></select><span class="mlr05 red">提示：选择商品后可以拖拽排序</span></div></div><div class="modal-body m-body"><div id="classifylist" class="fl scrollbar m-body-l"></div><div class="fl m-body-c"><div id="prdlist" class="scrollbar modalprdlists"></div><div class="prdpagecount"></div></div><div id="previewprd" class="fl scrollbar m-body-r modalprdlists"><ul></ul></div></div><div class="modal-footer"><button class="btn closeprdmodal" data-dismiss="modal" aria-hidden="true">关闭</button><button class="btn btn-primary prdsubmit">确定<span class="selectednum"></span></button></div></div>';var d=a("body").find("#myPrdModal").length;return 0>=d&&a(document.body).append(c[0]),b.$modalHTML=a("body").find("#myPrdModal"),b.setDom(),this},setDom:function(){return this.$searchinput=this.$modalHTML.find(".prd_k"),this.$searchbtn=this.$modalHTML.find(".j-search"),this.$salestatus=this.$modalHTML.find("#sale_status"),this.$classifylist=this.$modalHTML.find("#classifylist"),this.$contentlist=this.$modalHTML.find("#prdlist"),this.$singleconfirmbtn=this.$modalHTML.find("#prdlist li"),this.$previewprdlist=this.$modalHTML.find("#previewprd"),this.$multiselectbtn=this.$modalHTML.find(".prdsubmit"),this.$multiselectnum=this.$modalHTML.find(".selectednum"),this.$pagecontent=this.$modalHTML.find(".prdpagecount"),this.$pagebtn=this.$modalHTML.find(".prdpagecount span a"),this.$multiselectnum&&this.$multiselectnum.html(""),this},editprdid:function(){var a=this;if(a.$ele.attr("data-prdid")?a.$prdids=a.$ele.attr("data-prdid"):a.options.prdids?a.$prdids=a.options.prdids:a.$prdids="",a.$prdids){var b=a.$prdids.substr(a.$prdids.length-1,1);","==b&&(a.$prdids=a.$prdids.substr(0,a.$prdids.length-1)),a.$prdid_arr=a.$prdids.split(","),a.$prdid_arr&&a.$multiselectnum.html("("+a.$prdid_arr.length+")"),a.idsajax(a.$prdids),a.previewhtml()}return this},idsajax:function(b){var c=this;return a.ajax({type:"POST",url:c.$getprdbyids,data:{ids:b},dataType:"json",async:!1,success:function(a){c.$listdata_arr=a}}),c.$listdata_arr},show:function(){return this.$modalHTML.modal("show"),this},hide:function(){return this.$modalHTML.modal("hide"),this},showsearchbox:function(){return this.$searchinput.removeAttr("disabled"),this.$searchbtn.removeClass("disabled"),this.$salestatus.removeAttr("disabled"),this},hidesearchbox:function(){return this.$searchinput.attr("disabled","disabled"),this.$searchbtn.addClass("disabled"),this.$salestatus.attr("disabled","disabled"),this},getcurrentcid:function(){var a=this.$ele.attr("data-classfiy");return a||(a=0),a},initdata:function(){this.$previewprdlist.find("ul").html(""),this.editprdid();var a=this.getcurrentcid();return this.itemlist(),this.$classifylist.find("li").removeClass("active"),this.$classifylist.find("li[data-cid="+a+"]").addClass("active"),this.$salestatus.val(this.options.sale),this.getprdbyitem(a),this},getprdbyitem:function(a){if(0==a){var b=this.$postUrl+"&sale="+this.options.sale+"&community_id="+this.options.community_id;this.showsearchbox().plugslistinit(b)}else if("zc"==a)this.hidesearchbox().getplugmainlist("",this.$getactprd);else if("jf"==a)this.hidesearchbox().getplugmainlist("",this.$getscoreprd);else{var c=this.$classifyprd+"&classifyid="+a+"&sale="+this.options.sale+"&community_id="+this.options.community_id;this.showsearchbox().getprdBycid(c)}},itemlist:function(){var b=this;a.ajax({type:"POST",url:b.$itemList,data:{sale:b.options.sale},dataType:"json",async:!1,beforeSend:function(){b.$classifylist.html("<div class='dataloading'>加载中...</div>")},success:function(c){if("40001"==c.status)b.$classifylist.html("");else{var d="",e="",f=c.info;a.each(f,function(b,c){d+='<li data-cid="'+c.cid+'" data-id="'+c.id+'" data-show="'+c.visible+'">'+c.listname+(c.prd_count>0?"<code>"+c.prd_count+"</code>":"")+"</li>",c.sub&&c.sub.length>0&&a.each(c.sub,function(a,b){d+='<li class="item_sub" data-cid="'+b.cid+'" data-id="'+b.id+'" data-show="'+b.visible+'">'+b.listname+(b.prd_count>0?"<code>"+b.prd_count+"</code>":"")+"</li>"})}),e='<ul><li data-cid="0" data-id="0" data-show="0" class="active">所有分类</li>'+(b.options.storeid||"1"==b.options.is_virtual?"":'<li data-cid="zc" data-id="0" data-show="0" data-act="zc">众筹商品</li>')+(b.options.storeid||"1"==b.options.is_virtual?"":'<li data-cid="jf" data-id="0" data-show="0" data-act="jf">'+credit_mark+"换购商品</li>")+d+"</ul>",b.$classifylist.html(e)}}})},plugslistinit:function(a){this.$pagebtn.die("click"),this.getplugmainlist(1,a),this.ajaxpagemainlist(a)},getprdBycid:function(a){return this.plugslistinit(a),this},getplugmainhtml:function(b){var c=this,d="",e=c.options.alltag,f=c.options.hasonsale,g="",h=b.info;return a.each(h,function(a,b){var d="",h="";1==f&&(h+="onsale"==b.approve_status?'<span class="label label-success c_onsale">销售中</span>':'<span class="label">已下架</span>'),c.options.storeid||(b.prd_presell.status&&(-1!==e.indexOf("presell")&&(h+='<span class="label label-warning c_presell"  title="该商品正在参加<<'+b.prd_presell.actinfo.act_name+'>>活动">'+c.$act_title.presell+"</span>"),d+="presell,"),b.fans_special_price.status&&(-1!==e.indexOf("fans_special")&&(h+='<span class="label label-warning c_fans_special"  title="该商品正在参加<<'+b.fans_special_price.actinfo.act_name+'>>活动">'+c.$act_title.fans_special+"</span>"),d+="fans_special,"),b.prd_commonactivity.status&&(-1!==e.indexOf("commonactivity")&&(h+='<span class="label label-warning c_commonactivity"  title="该商品正在参加<<'+b.prd_commonactivity.actinfo.act_name+'>>活动">'+c.$act_title.commonactivity+"</span>"),d+="commonactivity,"),b.full_price_reduce_postage.status&&(-1!==e.indexOf("full_postage")&&(h+='<span class="label label-warning c_full_postage"  title="该商品正在参加<<'+b.full_price_reduce_postage.actinfo.act_name+'>>活动">满'+b.full_price_reduce_postage.actinfo.money+"元包邮</span>"),d+="full_postage,"),b.prd_fullreduced.status&&(-1!==e.indexOf("fullreduced")&&(h+='<span class="label label-warning c_fullreduced"  title="该商品正在参加<<'+b.prd_fullreduced.actinfo.act_name+'>>活动">'+c.$act_title.fullreduced+"</span>"),d+="fullreduced,"),b.prd_fullgift.status&&(-1!==e.indexOf("fullgift")&&(h+='<span class="label label-warning c_fullgift"  title="该商品正在参加<<'+b.prd_fullgift.actinfo.act_name+'>>活动">'+c.$act_title.fullgift+"</span>"),d+="fullgift,"),b.prd_groupbuy.status&&(-1!==e.indexOf("groupbuy")&&(h+='<span class="label label-warning c_groupbuy"  title="该商品正在参加<<'+b.prd_groupbuy.actinfo.act_name+'>>活动">'+c.$act_title.groupbuy+"</span>"),d+="groupbuy,"),b.prd_zcset.status&&(-1!==e.indexOf("zcset")&&(h+='<span class="label label-warning c_zcset"  title="该商品正在参加<<'+b.prd_zcset.actinfo.act_name+'>>活动">'+c.$act_title.zcset+"</span>"),d+="zcset,"),b.prd_cardinfo.status&&(-1!==e.indexOf("prd_card")&&(h+='<span class="label label-warning c_prd_card"  title="该商品正在参加<<'+b.prd_cardinfo.actinfo.act_name+'>>活动">'+c.$act_title.prd_card+"</span>"),d+="prd_card,"),b.prd_ticket.status&&(-1!==e.indexOf("coupon")&&(h+='<span class="label label-warning c_coupon"  title="该商品正在参加<<'+b.prd_ticket.actinfo.act_name+'>>活动">'+c.$act_title.coupon+"</span>"),d+="coupon,"),"1"==b.credit_to_price.status&&(-1!==e.indexOf("credit_cash")&&(h+='<span class="label label-warning c_credit_cash"  title="该商品正在参加<<'+b.prd_cardinfo.actinfo.act_name+'>>活动">'+c.$act_title.credit_cash+"</span>"),d+="credit_cash,"),"2"==b.credit_to_price.status&&(-1!==e.indexOf("credit_exchange")&&(h+='<span class="label label-warning c_credit_exchange"  title="该商品正在参加<<'+b.prd_cardinfo.actinfo.act_name+'>>活动">'+c.$act_title.credit_exchange+"</span>"),d+="credit_exchange,"),b.prd_wsq.status&&(-1!==e.indexOf("wsq")&&(h+='<span class="label label-warning c_wsq"  title="该商品已添加到该社区的产品库">微社区</span>'),d+="wsq,"),b.is_guidancesell.status&&(-1!==e.indexOf("guid")&&(h+='<span class="label label-warning c_guid"  title="该商品是流程引导商品">流程引导</span>'),d+="guid,"),b.is_virtual.status&&(-1!==e.indexOf("virtual")&&(h+='<span class="label label-info c_virtual"  title="该商品是虚拟商品">虚拟</span>'),d+="virtual,"),d=d.substring(0,d.length-1)),g+='<li data-id="'+b.id+'" id="a'+b.id+'" data-tag="'+d+'">',g+=b.prd_url?'<a href="'+b.prd_url+'" class="prdinfo">':'<a href="javascript:void(0);" class="prdinfo">',g+='<div class="pic" img="'+b.pic_url+'"><img src="'+b.pic_url+'_180x180.jpg"/></div><div class="prd-des"><p class="title">'+b.title+'</p><div><p class="price fl" price="'+b.price+'">￥'+b.price+'</p><div class="fr">'+h+'</div><div class="clearfix"></div></div></div></a></li>'}),d="<ul>"+g+"</ul>"},getplugmainlist:function(b,c){var d=this;a.ajax({type:"POST",url:c,data:{page:b},dataType:"json",beforeSend:function(){d.$contentlist.html("<div class='dataloading'>加载中...</div>"),d.$pagecontent.hide()},success:function(e){if("40001"==e.status)d.$contentlist.html("<div class='datawarn'>登陆超时，请<span class='btn-link' onclick='location.reload();'>刷新</span>页面重新登陆</div>"),d.$pagecontent.hide();else if(d.$contentlist.empty(),0==e.count)d.$contentlist.html("<div class='datawarn'>没有数据</div>"),d.$pagecontent.hide();else{e.countpage>1&&c!==d.$getactprd&&c!==d.$getactprd?(d.$pagecontent.show(),d.$total=e.count,d.$totalPage=e.countpage,d.$curPage=b):d.$pagecontent.html("<span>共"+e.count+"条数据</span>");var f=d.getplugmainhtml(e);d.$contentlist.html(f);var g=d.$searchinput.val();g=a.trim(g),a.hilightEle(d.$contentlist,g);var h=d.$listdata_arr.length;if(h>0)for(var i=0;h>i;i++){var j=d.$listdata_arr[i].dataid;d.$contentlist.find("li").each(function(){var b=a(this).attr("data-id");j==b&&a("#a"+j).addClass("btn-success")})}}},complete:function(){var b=a.getPageBar(d.$curPage,d.$totalPage,d.$total);d.$pagecontent.html(b)},error:function(){d.$contentlist.html("<div class='datawarn'>数据加载失败</div>"),d.$pagecontent.hide()}})},ajaxpagemainlist:function(b){var c=this;c.$pagebtn.live("click",function(){var d=a(this).attr("rel");d&&c.getplugmainlist(d,b)})},creatArray:function(a,b){var c=this,d=a.find("a").attr("href"),e=a.find(".pic").attr("img"),f=a.find(".title").text(),g=a.find(".price").attr("price");c.$listdata_obj={dataid:b,prd:d,pic:e,title:f,price:g}},previewhtml:function(){var a=this,b="",c=a.$listdata_arr.length;if(a.$multiselectnum.html("("+a.$listdata_arr.length+")"),c>0)for(var d=0;c>d;d++){var e=a.$listdata_arr[d].dataid,f=a.$listdata_arr[d].prd,g=a.$listdata_arr[d].pic,h=a.$listdata_arr[d].title,i=a.$listdata_arr[d].price;b+="<li data-id='"+e+"' id='p"+e+"'><span class='move_area'><i class='layer_icon_move' title='点击我可以拖拽排序哦'></i></span><a href='"+f+"'><div class='prdinfo'><div class='pic' img='"+g+"'><img src='"+g+"_180x180.jpg'></div><div class='prd-des'><p class='title'>"+h+"</p><p class='price' price='"+i+"'>￥"+i+"</p></div></div><div class='cancleprd'>X</div></a></li>"}a.$previewprdlist.find("ul").html(b)},checkedEle:function(b,c,d,e){if(b.hasClass("btn-success")){b.removeClass("btn-success");var f=b.attr("data-id");a.removeItem(d,f,"dataid")}else 0==e?(b.addClass("btn-success"),-1==jQuery.inArray(c,d)&&d.push(c)):d.length<e?(b.addClass("btn-success"),-1==jQuery.inArray(c,d)&&d.push(c)):alert("您最多选择"+e+"个")},execSearch:function(b){var c=this;if(""==a.trim(b))return alert("查询条件不能为空"),!1;b=a.trim(b);var d=c.getcurrentcid();if(0==d){var e=this.$postUrl+"&sale="+this.options.sale+"&title="+encodeURIComponent(b)+"&community_id"+this.options.community_id;this.showsearchbox().plugslistinit(e)}else{var f=this.$classifyprd+"&classifyid="+d+"&title="+encodeURIComponent(b)+"&sale="+this.options.sale+"&community_id="+this.options.community_id;this.showsearchbox().getprdBycid(f)}},bindEvent:function(){var b=this,c=b.$ele,d=b.options.num,e=b.options.notEle;b.options.community_id;return b.$salestatus.unbind(),b.$salestatus.bind("change",function(){b.options.sale=a(this).val();var c=b.getcurrentcid();b.itemlist(),b.$classifylist.find("li[data-cid='"+c+"']").trigger("click")}),b.$classifylist.undelegate(),b.$classifylist.delegate("li","click",function(d){var e=a(this),f=e.attr("data-cid");c.attr("data-classfiy",f),b.getprdbyitem(f),e.parent().children("li").removeClass("active"),e.addClass("active")}),b.$contentlist.undelegate(),b.$contentlist.delegate("li","click",function(f){f.preventDefault();var g=a(this),h=g.attr("data-id"),i=g.attr("data-tag");if(-1===e.indexOf("commonactivity")||-1===e.indexOf("fans_special")||-1===i.indexOf("commonactivity")||-1!=i.indexOf("fans_special")||g.hasClass("btn-success"))for(var j=0;j<e.length;j++){if(-1!==i.indexOf(e[j])&&g.hasClass("btn-success")){var k=i.substr(i.length-1,1);","!==k&&(i+=","),i=i.replace(e[j]+",",""),i=i.substring(0,i.length-1),g.find(".c_"+e[j]).remove(),g.attr("data-tag",i)}if(-1!==i.indexOf(e[j]))return"virtual"==e[j]?alert("该商品是虚拟商品，不能选择，请选择其他商品！"):alert("该商品正在参加"+b.$act_title[e[j]]+"活动，请选择其他商品！"),!1}else if(!confirm("此商品正在参加微团购活动，你确定选择此商品吗？【注：活动优先选择微团购活动】"))return!1;return b.creatArray(g,h),1==d?(c.attr("data-prdid",b.$listdata_obj.dataid),b.options.backdatainfo(c,b.$listdata_obj),b.hide(),!1):(b.checkedEle(g,b.$listdata_obj,b.$listdata_arr,d),void b.previewhtml())}),b.$previewprdlist.undelegate(),b.$previewprdlist.delegate("li .cancleprd","click",function(){var c=a(this),d=c.parents("li").attr("data-id");c.parents("li").remove(),a.removeItem(b.$listdata_arr,d,"dataid");var e=b.$listdata_arr.length;b.$multiselectnum.html("("+e+")"),e>=0&&b.$contentlist.find("li.btn-success").each(function(){var c=a(this).attr("data-id");a(this).removeClass("btn-success");for(var d=0;e>d;d++){var f=b.$listdata_arr[d].dataid;c==f&&a("#a"+c).addClass("btn-success")}})}),b.$previewprdlist.delegate("li","click",function(a){a.preventDefault()}),b.$previewprdlist.find("ul").sortable({opacity:.8,cursor:"move",axis:"y",update:function(){b.$listdata_arr.splice(0,b.$listdata_arr.length),b.$previewprdlist.find("li").each(function(){var c=a(this),d=c.attr("data-id");b.creatArray(c,d),b.$listdata_arr.push(b.$listdata_obj)})}}),b.$searchbtn&&(b.$searchbtn.die(),b.$searchbtn.live("click",function(){var c=a(this).prev(".prd_k").val();a(this).hasClass("disabled")||b.execSearch(c)}),b.$searchinput.live("keyup change",function(c){var d=a(this).val(),d=a.trim(d);d&&a.hilightEle(b.$contentlist,d),13==c.keyCode&&b.execSearch(d)})),a(".closeprdmodal").live("click",function(){var a=b.$listdata_arr.length;if(a>0){for(var d="",e=0;a>e;e++)d+=b.$listdata_arr[e].dataid+",";d=d.substring(0,d.length-1),c.attr("data-prdid",d),b.hide()}}),a.isFunction(b.options.backdatainfo)&&(b.$multiselectbtn.unbind(),b.$multiselectbtn.bind("click",function(){var a=b.$listdata_arr.length;if(!(a>0))return alert("请选择商品"),!1;for(var d="",e=0;a>e;e++)d+=b.$listdata_arr[e].dataid+",";d=d.substring(0,d.length-1),c.attr("data-prdid",d),b.options.backdatainfo(c,b.$listdata_arr),b.hide()})),this}};var e=a.fn[b];a.fn[b]=function(c){return this.each(function(){var e=a(this),f=e.data("selectPlugsData"),g=a.fn[b].pluginData[f],h="object"==typeof c&&c;g||(f=a.fn[b].pluginData.index++,a.fn[b].pluginData[f]=new d(this,h),e.data("selectPlugsData",f),g=a.fn[b].pluginData[f]),g.initdata().bindEvent().show()})},a.fn[b].pluginData={index:0},a.fn[b].Constructor=b,a.fn[b].noConflict=function(){return a.fn[b]=e,this},a(document).ready(function(){a('[data-plug="'+b+'"]').each(function(){var c=a(this),d=this.dataset;a.fn[b].call(c,d)})}),d.version="1.0.0"}($);
!function(a){var b="selectCoupon",c={host:"",num:1,type:1,scenestate:"",couponid:"",is_stock:"",backdatainfo:function(){}},d=function(b,d){this.$ele=a(b),this.options=a.extend({},c,d),this.init()};d.prototype={initDom:function(){return this.$scenestate_arr={sale:"guidancesell",send:"guidancegive",pay:"offlinepayafter",recharge:"offlinerechargeafter",sign:"signprize",fans:"manualgivefans",act:"activity",vip:"vipcard",vipprize:"vipprize",appsend:"manualsend"},this.$scenestate_name={sale:"流程引导售券",send:"流程引导送券",pay:"线下支付后下发",recharge:"线下储值后下发",sign:"连续签到奖品",fans:"粉丝管理维护手动下发",act:"营销活动",vip:"会员卡信息变动通知下发",vipprize:"会员卡开卡奖励",appsend:"app上手动送券"},this.$current_val=this.options.scenestate?this.$scenestate_arr[this.options.scenestate]:"",this.$current_name=this.options.scenestate?this.$scenestate_name[this.options.scenestate]:"",this.$total="",this.$totalPage="",this.$curPage=1,this.$listdata_obj="",this.$listdata_arr=[],this.$getcoupon=this.options.host+"/index.php/shangjia/commoncomponent/getcoupon?type="+this.options.type+"&scenestate="+this.$current_val+"&is_stock="+this.options.is_stock,this.$couponinfo=this.options.host+"/index.php/shangjia/commoncomponent/couponinfo",this.$creatnewurl=this.options.host+"/index.php/shangjia/coupon/newcoupons",this},init:function(){var a=/^\d+$/.test(this.options.num);return a?(this.initDom().create(),this):(alert("请填写正确的选择数量的参数"),!1)},create:function(){var b=this,c=[];c[0]='<div id="MyCouponModal" class="modal hide fade" tabindex="-1" role="dialog" aria-hidden="true" data-width="700"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button><h3 class="fl">选择<span class="scenestate_name">【'+b.$current_name+'】</span>优惠券</h3><a href="'+b.$creatnewurl+'" class="btn btn-success fr" target="_blank" style="margin-right:20px;">新建优惠券</a><span class="btn fr refreshbtn">刷新</span><div class="clearfix"></div></div><div class="modal-body"><div class="scrollbar linkbox" id="mycouponlist"></div><div class="prdpagecount"></div></div><div class="modal-footer"><button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button><button class="btn btn-primary couponsubmit">确定<span class="coupon_num"></span></button></div></div>';var d=a("body").find("#MyCouponModal").length;return 0>=d&&a(document.body).append(c[0]),b.$modalHTML=a("body").find("#MyCouponModal"),b.setDom(),this},setDom:function(){return this.$scene_name=this.$modalHTML.find(".scenestate_name"),this.$refreshbtn=this.$modalHTML.find(".refreshbtn"),this.$contentlist=this.$modalHTML.find("#mycouponlist"),this.$singleconfirmbtn=this.$modalHTML.find(".selcouponbtn"),this.$multiselectbtn=this.$modalHTML.find(".couponsubmit"),this.$multiselectnum=this.$modalHTML.find(".coupon_num"),this.$pagecontent=this.$modalHTML.find(".prdpagecount"),this.$pagebtn=this.$modalHTML.find(".prdpagecount span a"),this.$multiselectnum&&this.$multiselectnum.html(""),this},editcouponid:function(){var a=this;if(a.$ele.attr("data-ids")?a.$couponids=a.$ele.attr("data-ids"):a.options.couponid?a.$couponids=a.options.couponid:a.$couponids="",a.$couponids){var b=a.$couponids.substr(a.$couponids.length-1,1);","==b&&(a.$couponids=a.$couponids.substr(0,a.$couponids.length-1)),a.$couponid_arr=a.$couponids.split(","),a.$couponid_arr&&a.$multiselectnum.html("("+a.$couponid_arr.length+")")}if(a.options.couponid&&!a.$ele.attr("data-ids"))for(var c=0;c<a.$couponid_arr.length;c++){var d=a.$couponid_arr[c];a.getcouponinfo(d)}return this},getcouponinfo:function(b){var c=this;a.ajax({type:"POST",url:c.$couponinfo,data:{id:b},dataType:"json",success:function(a){var b=a.result[0],d=b.id,e=b.group_name,f=b.group_parvalue,g=b.group_etime,h=b.group_quantity,i={id:d,title:e,value:f,num:h,etime:g};c.$listdata_arr.push(i)}})},show:function(){return this.$modalHTML.modal("show"),this.$current_name?this.$scene_name.html("【"+this.$current_name+"】"):this.$scene_name.html(""),this},hide:function(){return this.$modalHTML.modal("hide"),this},initdata:function(){return this.editcouponid(),this.plugslistinit(this.$getcoupon),this},plugslistinit:function(a){this.$pagebtn.die("click"),this.getplugmainlist(1,a),this.ajaxpagemainlist(a)},getplugmainhtml:function(b){var c="",d='<table style="width:100%;"><tr><th>名称</th><th>优惠金额</th><th>过期时间</th><th>已领取/数量</th><th width="80">操作</th></tr>',e="",f=b.result;a.each(f,function(a,b){e+='<tr data-id="'+b.id+'"><td><span class="coupon_title" title="'+b.group_name+'">'+b.group_name+"</span></td><td>"+b.group_parvalue+"</td><td>"+b.group_etime+"</td><td>"+b.drawNum+"/"+b.group_quantity+'</td><td><a href="javascript:void(0);" class="btn-link selcouponbtn" data-id="'+b.id+'" data-title="'+b.group_name+'" data-value="'+b.group_parvalue+'" data-etime="'+b.group_etime+'" data-num="'+b.group_quantity+'">选择</a></td></tr>'});var g="</table>";return c=d+e+g},getplugmainlist:function(b,c){var d=this;a.ajax({type:"POST",url:c,data:{page:b},dataType:"json",beforeSend:function(){d.$contentlist.html("<div class='dataloading'>加载中...</div>"),d.$pagecontent.hide()},success:function(c){if("40001"==c.status)d.$contentlist.html("<div class='datawarn'>登陆超时，请<span class='btn-link' onclick='location.reload();'>刷新</span>页面重新登陆</div>"),d.$pagecontent.hide();else if(d.$contentlist.empty(),0==c.totalpage)d.$contentlist.html("<div class='datawarn'>没有数据，去创建"+(d.$current_name?"【"+d.$current_name+"】专属场景的":"")+"优惠券</div>"),d.$pagecontent.hide();else{c.totalpage>1&&(d.$pagecontent.show(),d.$total=c.totalnum,d.$totalPage=c.totalpage,d.$curPage=b);var e=d.getplugmainhtml(c);if(d.$contentlist.html(e),d.$couponid_arr&&d.$couponid_arr.length>0)for(var f=0;f<d.$couponid_arr.length;f++){var g=d.$couponid_arr[f];d.$modalHTML.find(".selcouponbtn").each(function(){var b=a(this).attr("data-id");g==b&&a(this).html("取消选择")})}}},complete:function(){var b=a.getPageBar(d.$curPage,d.$totalPage,d.$total);d.$pagecontent.html(b)},error:function(){d.$contentlist.html("<div class='datawarn'>数据加载失败</div>"),d.$pagecontent.hide()}})},ajaxpagemainlist:function(b){var c=this;c.$pagebtn.live("click",function(){var d=a(this).attr("rel");d&&c.getplugmainlist(d,b)})},checkedEle:function(b,c,d,e){var f=this;if("取消选择"==b.html()){b.html("选择");var g=b.attr("data-id");a.removeItem(d,g,"id")}else 0==e?(b.html("取消选择"),-1==jQuery.inArray(c,d)&&d.push(c)):d.length<e?(b.html("取消选择"),-1==jQuery.inArray(c,d)&&d.push(c)):alert("您最多选择"+e+"个");f.$multiselectnum.html("("+f.$listdata_arr.length+")")},bindEvent:function(){var b=this,c=b.$ele;return b.$refreshbtn.die(),b.$refreshbtn.live("click",function(){b.$multiselectnum&&b.$multiselectnum.html(""),b.initdata()}),a.isFunction(b.options.backdatainfo)&&(b.$singleconfirmbtn.die(),b.$singleconfirmbtn.live("click",function(){var d=a(this),e=d.attr("data-id"),f=d.attr("data-title"),g=d.attr("data-value"),h=d.attr("data-etime"),i=d.attr("data-num");return b.$listdata_obj={id:e,title:f,value:g,num:i,etime:h},1==b.options.num?(b.options.backdatainfo(c,b.$listdata_obj)!==!1&&b.hide(),!1):void b.checkedEle(d,b.$listdata_obj,b.$listdata_arr,b.options.num)}),1!==b.options.num&&(b.$multiselectbtn.unbind(),b.$multiselectbtn.bind("click",function(){for(var a="",d=0;d<b.$listdata_arr.length;d++)a+=b.$listdata_arr[d].id+",";c.attr("data-ids",a),b.options.backdatainfo(c,b.$listdata_arr)!==!1&&b.hide()}))),this}};var e=a.fn[b];a.fn[b]=function(c){return this.each(function(){var e=a(this),f=e.data("selectPlugsData"),g=a.fn[b].pluginData[f],h="object"==typeof c&&c;g||(f=a.fn[b].pluginData.index++,a.fn[b].pluginData[f]=new d(this,h),e.data("selectPlugsData",f),g=a.fn[b].pluginData[f]),g.initdata().bindEvent().show()})},a.fn[b].pluginData={index:0},a.fn[b].Constructor=b,a.fn[b].noConflict=function(){return a.fn[b]=e,this},a(document).ready(function(){a('[data-plug="'+b+'"]').each(function(){var c=a(this),d=this.dataset;a.fn[b].call(c,d)})}),d.version="1.0.0"}($);
!function(a){var b="selectForm",c={host:"",backdatainfo:function(){}},d=function(b,d){this.$ele=a(b),this.options=a.extend({},c,d),this.init()};d.prototype={initDom:function(){return this.$total="",this.$totalPage="",this.$curPage=1,this.$listdata_obj="",this.$listdata_arr=[],this.$getallform=this.options.host+"/index.php/shangjia/commoncomponent/getforminfo",this.$previewform=this.options.host+"/index.php/shangjia/diypage/previewdiyform",this.$creatnewurl=this.options.host+"/index.php/shangjia/diypage/newform?v=1",this},init:function(){return this.initDom().create().initdata().bindEvent(),this},create:function(){var b=this,c=[];c[0]='<div id="MyFromModal" class="modal hide fade" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button><h3>选择表单</h3><input type="text"  placeholder="万能表单标题" name="form_k" class="prd_k"/><button class="btn j-search">查询</button><a href="'+b.$creatnewurl+'" class="btn btn-success fr" target="_blank">新建万能表单</a><span class="btn fr refreshbtn">刷新</span></div><div class="modal-body"><div class="scrollbar linkbox" id="myformlist"></div><div class="prdpagecount"></div></div><div class="modal-footer"><button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button></div></div>';var d=a("body").find("#MyFromModal").length;return 0>=d&&a(document.body).append(c[0]),b.$modalHTML=a("body").find("#MyFromModal"),b.setDom(),this},setDom:function(){return this.$searchinput=this.$modalHTML.find(".prd_k"),this.$searchbtn=this.$modalHTML.find(".j-search"),this.$refreshbtn=this.$modalHTML.find(".refreshbtn"),this.$contentlist=this.$modalHTML.find("#myformlist"),this.$singleconfirmbtn=this.$modalHTML.find(".selformbtn"),this.$pagecontent=this.$modalHTML.find(".prdpagecount"),this.$pagebtn=this.$modalHTML.find(".prdpagecount span a"),this.$searchinput&&this.$searchinput.val(""),this},show:function(){return this.$modalHTML.modal("show"),this},hide:function(){return this.$modalHTML.modal("hide"),this},initdata:function(){return this.plugslistinit(this.$getallform),this},plugslistinit:function(a){this.$pagebtn.die("click"),this.getplugmainlist(1,a),this.ajaxpagemainlist(a)},getplugmainhtml:function(b){var c="",d='<table style="width:100%;"><tr><th>名称</th><th width="35%">创建时间</th><th width="20%">操作</th></tr>',e="",f=b.info;a.each(f,function(a,b){e+='<tr data-id="'+b.id+'"><td><span class="from_title" title="'+b.name+'">'+b.name+"</span></td><td>"+b.creat_time+'</td><td><a href="javascript:void(0);" class="btn-link selformbtn" data-id="'+b.id+'" data-title="'+b.name+'" data-url="'+b.redirect_url+'" data-filename="'+b.filename+'">选择</a></td></tr>'});var g="</table>";return c=d+e+g},getplugmainlist:function(b,c){var d=this;a.ajax({type:"POST",url:c,data:{page:b},dataType:"json",beforeSend:function(){d.$contentlist.html("<div class='dataloading'>加载中...</div>"),d.$pagecontent.hide()},success:function(c){if("40001"==c.status)d.$contentlist.html("<div class='datawarn'>登陆超时，请<span class='btn-link' onclick='location.reload();'>刷新</span>页面重新登陆</div>"),d.$pagecontent.hide();else if(d.$contentlist.empty(),0==c.countpage)d.$contentlist.html("<div class='datawarn'>没有数据</div>"),d.$pagecontent.hide();else{c.countpage>1&&(d.$pagecontent.show(),d.$total=c.count,d.$totalPage=c.countpage,d.$curPage=b);var e=d.getplugmainhtml(c);d.$contentlist.html(e);var f=d.$searchinput.val();f=a.trim(f),a.hilightEle(d.$contentlist,f)}},complete:function(){var b=a.getPageBar(d.$curPage,d.$totalPage,d.$total);d.$pagecontent.html(b)},error:function(){d.$contentlist.html("<div class='datawarn'>数据加载失败</div>"),d.$pagecontent.hide()}})},ajaxpagemainlist:function(b){var c=this;c.$pagebtn.live("click",function(){var d=a(this).attr("rel");d&&c.getplugmainlist(d,b)})},execSearch:function(b){var c=this;if(""==a.trim(b))return alert("查询条件不能为空"),!1;b=a.trim(b);var d=c.$getallform+"?title="+encodeURIComponent(b);c.plugslistinit(d)},previewform:function(b,c){var d=this,e=d.$ele,f=!0;f&&a.ajax({type:"POST",url:d.$previewform,data:{id:b,t:1},success:function(a){f=!1,d.options.backdatainfo(e,c,a),d.hide()}})},bindEvent:function(){var b=this;b.$ele;b.$refreshbtn.die(),b.$refreshbtn.live("click",function(){b.$searchinput&&b.$searchinput.val(""),b.initdata()}),b.$searchbtn&&(b.$searchbtn.die(),b.$searchbtn.live("click",function(){var c=a(this).prev(".prd_k").val();b.execSearch(c)}),b.$searchinput.live("keyup change",function(c){var d=a(this).val(),d=a.trim(d);d&&a.hilightEle(b.$contentlist,d),13==c.keyCode&&b.execSearch(d)})),a.isFunction(b.options.backdatainfo)&&(b.$singleconfirmbtn.die(),b.$singleconfirmbtn.live("click",function(){var c=a(this),d=c.attr("data-id"),e=c.attr("data-title"),f=c.attr("data-filename"),g=c.attr("data-url");b.$listdata_obj={id:d,title:e,filename:f,url:g},b.previewform(d,b.$listdata_obj)}))}};var e=a.fn[b];a.fn[b]=function(c){return this.each(function(){var e=a(this),f=e.data("selectPlugsData"),g=a.fn[b].pluginData[f],h="object"==typeof c&&c;g||(f=a.fn[b].pluginData.index++,a.fn[b].pluginData[f]=new d(this,h),e.data("selectPlugsData",f),g=a.fn[b].pluginData[f]),g.show()})},a.fn[b].pluginData={index:0},a.fn[b].Constructor=b,a.fn[b].noConflict=function(){return a.fn[b]=e,this},a(document).ready(function(){a('[data-plug="'+b+'"]').each(function(){var c=a(this),d=this.dataset;a.fn[b].call(c,d)})}),d.version="1.0.0"}($);
!function(a){var b="selectFunCard",c={host:"",allTabs:["prdcard","creditcard"],backdatainfo:function(){}},d=function(b,d){this.$ele=a(b),this.options=a.extend({},c,d),this.init()};d.prototype={initDom:function(){return this.$total="",this.$totalPage="",this.$curPage=1,this.$listdata_obj="",this.$getfuncardlist=this.options.host+"/index.php/shangjia/commoncomponent/getpickupcard",this.$getfuncardprds=this.options.host+"/index.php/shangjia/commoncomponent/getprddetailinfo",this.$creatnewurl=this.options.host+"/index.php/shangjia/cardgroup/add",this.$tabs_title={prdcard:"提货卡",savingcard:"储蓄卡",creditcard:credit_mark+"卡"},this.$tabs_type={prdcard:"1",savingcard:"2",creditcard:"3"},this.$tabs_typetitle={1:"提货卡",2:"储蓄卡",3:credit_mark+"卡"},this},init:function(){return this.initDom().create().bindEvent(),this},create:function(){var b=this,c=[];c[0]='<div id="myFuncardModal" class="modal hide fade" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button><h3 class="fl">选择功能卡</h3><a href="'+b.$creatnewurl+'" class="btn btn-success fr" target="_blank" style="margin-right:20px;">新建功能卡</a><span class="btn fr refreshbtn">刷新</span><div class="clearfix"></div></div><div class="modal-body"><div class="tabbable tabs-left"><ul class="nav nav-tabs tabnavs"></ul><div class="tab-content tabcontent"></div></div></div><div class="modal-footer"><button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button></div></div>';var d=a("body").find("#myFuncardModal").length;return 0>=d&&a(document.body).append(c[0]),b.$modalHTML=a("body").find("#myFuncardModal"),b.setDom(),this},creatnav:function(){for(var a=this,b="",c="",d=a.options.allTabs,e=0;e<d.length;e++)b+='<li data-mark="'+d[e]+'"><a href="#'+d[e]+'_list" data-toggle="tab">'+a.$tabs_title[d[e]]+"</a></li>",-1!==d.indexOf(d[e])&&(c+='<div class="tab-pane mycardlists" id="'+d[e]+'_list"><div id="my'+d[e]+'List" class="scrollbar linkbox"></div><div class="prdpagecount"></div></div>');return a.$modalHTML.find(".tabnavs").html(b),a.$modalHTML.find(".tabcontent").html(c),this},setDom:function(){return this.$refreshbtn=this.$modalHTML.find(".refreshbtn"),this.$tabnav=this.$modalHTML.find(".tabnavs"),this.$tabcontent=this.$modalHTML.find(".tabcontent"),this.$singleconfirmbtn=this.$modalHTML.find(".selfuncardbtn"),this.$showprdlist=this.$modalHTML.find(".getcard_usedprds"),this.$searchinput&&this.$searchinput.val(""),this},show:function(){return this.$modalHTML.modal("show"),this},hide:function(){return this.$modalHTML.modal("hide"),this},getcurrentmark:function(){var a=this.$ele.attr("data-classfiy");return a||(a=this.options.allTabs[0]),a},initdata:function(){var a=this.getcurrentmark();return this.$tabnav.find("li[data-mark="+a+"]").addClass("active").siblings().removeClass("active"),this.$tabcontent.find("#"+a+"_list").addClass("active").siblings().removeClass("active"),this.$contentlist=this.$modalHTML.find("#my"+a+"List"),this.$pagecontent=this.$modalHTML.find("#"+a+"_list .prdpagecount"),this.$pagebtn=this.$modalHTML.find("#"+a+"_list .prdpagecount span a"),this.plugslistinit(this.$getfuncardlist+"?card_type="+this.$tabs_type[a]),this},plugslistinit:function(a){this.$pagebtn.die("click"),this.getplugmainlist(1,a),this.ajaxpagemainlist(a)},getplugmainhtml:function(b){var c="",d=this.getcurrentmark();if("prdcard"==d)var e='<table style="width:100%;"><tr><th>功能卡名称</th><th>面值</th><th>数量</th><th>有效期</th><th>已选择商品</th><th>备注</th><th width="80">操作</th></tr>';else var e='<table style="width:100%;"><tr><th>'+credit_mark+"卡名称</th><th>"+credit_mark+'值</th><th>数量</th><th>有效期</th><th>备注</th><th width="80">操作</th></tr>';var f="",g=b.result;a.each(g,function(a,b){var c;c=b.group_remark?b.group_remark:"无",f+='<tr data-id="'+b.group_id+'"><td><span class="funcard_title" title="'+b.group_name+'">'+b.group_name+"</span></td><td>"+b.group_parvalue+"</td><td>"+b.group_quantity+"</td><td>"+b.group_valid+"</td>","prdcard"==d&&(f+='<td><a class="btn-link getcard_usedprds" data-prdids='+b.prdid+">查看商品</a></td>"),f+="<td>"+c+'</td><td><a href="javascript:void(0);" class="btn-link selfuncardbtn" data-id="'+b.group_id+'" data-title="'+b.group_name+'" data-value="'+b.group_parvalue+'" data-num="'+b.group_quantity+'" data-type="'+b.group_type2+'" data-prdid="'+b.prdid+'" data-time="'+b.group_valid+'">选择</a></td></tr>'});var h="</table>";return c=e+f+h},getplugmainlist:function(b,c){var d=this;a.ajax({type:"POST",url:c,data:{page:b},dataType:"json",beforeSend:function(){d.$contentlist.html("<div class='dataloading'>加载中...</div>"),d.$pagecontent.hide()},success:function(a){if("40001"==a.status)d.$contentlist.html("<div class='datawarn'>登陆超时，请<span class='btn-link' onclick='location.reload();'>刷新</span>页面重新登陆</div>"),d.$pagecontent.hide();else if(d.$contentlist.empty(),0==a.totalPage)d.$contentlist.html("<div class='datawarn'>没有数据</div>"),d.$pagecontent.hide();else{a.totalPage>1&&(d.$pagecontent.show(),d.$total=a.count,d.$totalPage=a.totalPage,d.$curPage=b);var c=d.getplugmainhtml(a);d.$contentlist.html(c)}},complete:function(){var b=a.getPageBar(d.$curPage,d.$totalPage,d.$total);d.$pagecontent.html(b)},error:function(){d.$contentlist.html("<div class='datawarn'>数据加载失败</div>"),d.$pagecontent.hide()}})},ajaxpagemainlist:function(b){var c=this;c.$pagebtn.live("click",function(){var d=a(this).attr("rel");d&&c.getplugmainlist(d,b)})},creatprdmodal:function(){var a='<div id="mycardprdModal" class="modal hide fade" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button><h3>当前提货卡选择的商品</h3></div><div class="modal-body"></div><div class="modal-footer"><button class="btn btn-primary closecardprdmodal" data-dismiss="modal" aria-hidden="true">确定</button></div></div>';return a},prdidsajax:function(b){var c=this;a.ajax({type:"POST",url:c.$getfuncardprds,data:{ids:b},dataType:"json",success:function(b){for(var c="",d=0;d<b.length;d++)c+='<li data-id="'+b[d].dataid+'" class="prdinfo"><div class="pic"><img src="'+b[d].pic+'"></div><div class="prd-des"><div class="prdtitle">'+b[d].title+'</div><div class="price">￥'+b[d].price+"</div></div></li>";a("#mycardprdModal").modal("show").find(".modal-body").html('<ul class="modalprdlists">'+c+"</ul>")}})},bindEvent:function(){var b=this,c=b.$ele;b.$refreshbtn.die(),b.$refreshbtn.live("click",function(){b.initdata()}),b.$showprdlist.undelegate(),b.$showprdlist.live("click",function(){var c=a(this).attr("data-prdids"),d=b.creatprdmodal(),e=a("body").find("#mycardprdModal").length;0>=e&&a(document.body).append(d),b.prdidsajax(c)}),b.$tabnav.undelegate(),b.$tabnav.delegate("li","click",function(){var d=a(this).attr("data-mark"),e=a("#my"+d+"List").find("table").length,f=a("#my"+d+"List").find(".datawarn").length;c.attr("data-classfiy",d),0>=e&0>=f?b.initdata():(b.$contentlist=b.$modalHTML.find("#my"+d+"List"),b.$pagecontent=b.$modalHTML.find("#"+d+"_list .prdpagecount"),b.$pagebtn=b.$modalHTML.find("#"+d+"_list .prdpagecount span a"))}),a.isFunction(b.options.backdatainfo)&&(b.$singleconfirmbtn.die(),b.$singleconfirmbtn.live("click",function(){var d=a(this);return id=d.attr("data-id"),title=d.attr("data-title"),num=d.attr("data-num"),time=d.attr("data-time"),cvalue=d.attr("data-value"),type=d.attr("data-type"),prdid=d.attr("data-prdid"),typeinfo=b.$tabs_typetitle[type],b.$listdata_obj={id:id,title:title,num:num,time:time,value:cvalue,type:type,typeinfo:typeinfo,prdid:prdid},b.options.backdatainfo(c,b.$listdata_obj),b.hide(),!1}))}};var e=a.fn[b];a.fn[b]=function(c){return this.each(function(){var e=a(this),f=e.data("selectPlugsData"),g=a.fn[b].pluginData[f],h="object"==typeof c&&c;g||(f=a.fn[b].pluginData.index++,a.fn[b].pluginData[f]=new d(this,h),e.data("selectPlugsData",f),g=a.fn[b].pluginData[f]),g.creatnav().initdata().show()})},a.fn[b].pluginData={index:0},a.fn[b].Constructor=b,a.fn[b].noConflict=function(){return a.fn[b]=e,this},a(document).ready(function(){a('[data-plug="'+b+'"]').each(function(){var c=a(this),d=this.dataset;a.fn[b].call(c,d)})}),d.version="1.0.0"}($);
!function(a){var b="selectImgTxt",c={host:"",num:1,isbackimgtxt:0,allTabs:["single","double","text","voice"],backdatainfo:function(){}},d=function(b,d){this.$ele=a(b),this.options=a.extend({},c,d),this.init()};d.prototype={initDom:function(){return this.$total="",this.$totalPage="",this.$curPage=1,this.$listdata_obj="",this.$listdata_arr=[],this.$getpicnews=this.options.host+"/index.php/shangjia/commoncomponent/getpicnews",this.$getwxreply=this.options.host+"/index.php/shangjia/catslist/wxreplaydisplay",this.$creatnewurl=this.options.host+"/index.php/shangjia/account/wxauto",this.$getimgtxtbyids=this.options.host+"/index.php/shangjia/commoncomponent/getimage",this.$tabs_title={single:"单图文","double":"多图文",text:"文字消息",voice:"语音消息"},this.$tabs_type={single:"2","double":"3",text:"1",voice:"5"},this.$tabs_typetitle={2:"单图文",3:"多图文",1:"文字消息",5:"语音消息"},this},init:function(){return this.initDom().create(),this},create:function(){var b=this,c=[];c[0]='<div id="ImgtxtModal" class="modal hide fade" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button><h3>选择图文素材</h3><input type="text"  placeholder="图文素材标题" name="imgtxt_k" class="prd_k"/><button class="btn j-search">查询</button><a href="'+b.$creatnewurl+'" class="btn btn-success fr" target="_blank">新建图文</a><span class="btn fr refreshbtn">刷新</span></div><div class="modal-body"><div class="tabbable tabs-left"><ul class="nav nav-tabs tabnavs"></ul><div class="tab-content tabcontent"></div></div></div><div class="modal-footer"><button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button><button class="btn btn-primary imgtxtsubmit">确定<span class="imgtxt_num"></span></button></div></div>';var d=a("body").find("#ImgtxtModal").length;return 0>=d&&a(document.body).append(c[0]),b.$modalHTML=a("body").find("#ImgtxtModal"),b.setDom(),this},creatnav:function(){for(var a=this,b="",c="",d=a.options.allTabs,e=0;e<d.length;e++)b+='<li data-mark="'+d[e]+'"><a href="#'+d[e]+'_imgtxt" data-toggle="tab">'+a.$tabs_title[d[e]]+"</a></li>",-1!==d.indexOf(d[e])&&(c+='<div class="tab-pane imgtxtlists" id="'+d[e]+'_imgtxt"><div id="'+d[e]+'List" class="scrollbar linkbox"></div><div class="prdpagecount"></div></div>');return a.$modalHTML.find(".tabnavs").html(b),a.$modalHTML.find(".tabcontent").html(c),this},setDom:function(){return this.$searchinput=this.$modalHTML.find(".prd_k"),this.$searchbtn=this.$modalHTML.find(".j-search"),this.$refreshbtn=this.$modalHTML.find(".refreshbtn"),this.$tabnav=this.$modalHTML.find(".tabnavs"),this.$tabcontent=this.$modalHTML.find(".tabcontent"),this.$singleconfirmbtn=this.$modalHTML.find(".selimgtxtbtn"),this.$multiselectbtn=this.$modalHTML.find(".imgtxtsubmit"),this.$multiselectnum=this.$modalHTML.find(".imgtxt_num"),this.$searchinput&&this.$searchinput.val(""),this},show:function(){return this.$modalHTML.modal("show"),this},hide:function(){return this.$modalHTML.modal("hide"),this},getcurrentmark:function(){var a=this.$ele.attr("data-classfiy");return a||(a=this.options.allTabs[0]),a},initdata:function(){var a=this.getcurrentmark();return this.$tabnav.find("li[data-mark="+a+"]").addClass("active").siblings().removeClass("active"),this.$tabcontent.find("#"+a+"_imgtxt").addClass("active").siblings().removeClass("active"),this.$contentlist=this.$modalHTML.find("#"+a+"List"),this.$pagecontent=this.$modalHTML.find("#"+a+"_imgtxt .prdpagecount"),this.$pagebtn=this.$modalHTML.find("#"+a+"_imgtxt .prdpagecount span a"),this.plugslistinit(this.$getpicnews+"?type="+this.$tabs_type[a]),this},editimgtxtid:function(){var a=this,b=a.$ele.attr("data-ids");if(b){a.$listdata_arr=[];var c=b.substr(b.length-1,1);","==c&&(b=b.substr(0,b.length-1)),a.$listdata_arr=a.idsajax(b),a.$listdata_arr&&a.$multiselectnum.html("("+a.$listdata_arr.length+")")}return this},idsajax:function(b){var c=this;return a.ajax({type:"POST",url:c.$getimgtxtbyids,data:{ids:b},dataType:"json",async:!1,success:function(a){a.map(function(a){a.typeinfo=c.$tabs_typetitle[a.type]}),c.$listdata_arr=a}}),c.$listdata_arr},plugslistinit:function(a){this.$pagebtn.die("click"),this.getplugmainlist(1,a),this.ajaxpagemainlist(a)},getplugmainhtml:function(b){var c="",d='<table style="width:100%;"><tr><th>名称</th><th width="35%">创建时间</th><th width="20%">操作</th></tr>',e="",f=b.info;a.each(f,function(a,b){e+='<tr data-id="'+b.id+'"><td><span class="imgtxt_title" title="'+b.title+'">'+b.title+"</span></td><td>"+b.creat_time+'</td><td><a href="javascript:void(0);" class="btn-link selimgtxtbtn" data-id="'+b.id+'" data-title="'+b.title+'" data-type="'+b.type+'" data-info="'+encodeURIComponent(b.info)+'">选择</a></td></tr>'});var g="</table>";return c=d+e+g},getplugmainlist:function(b,c){var d=this;a.ajax({type:"POST",url:c,data:{page:b},dataType:"json",beforeSend:function(){d.$contentlist.html("<div class='dataloading'>加载中...</div>"),d.$pagecontent.hide()},success:function(c){if("40001"==c.status)d.$contentlist.html("<div class='datawarn'>登陆超时，请<span class='btn-link' onclick='location.reload();'>刷新</span>页面重新登陆</div>"),d.$pagecontent.hide();else if(d.$contentlist.empty(),0==c.countpage)d.$contentlist.html("<div class='datawarn'>没有数据</div>"),d.$pagecontent.hide();else{c.countpage>1&&(d.$pagecontent.show(),d.$total=c.count,d.$totalPage=c.countpage,d.$curPage=b);var e=d.getplugmainhtml(c);d.$contentlist.html(e);var f=d.$searchinput.val();f=a.trim(f),a.hilightEle(d.$contentlist,f);var g=d.$listdata_arr.length;if(g>0)for(var h=0;g>h;h++){var i=d.$listdata_arr[h].id;a(".imgtxtlists").find("tr").each(function(){var b=a(this).attr("data-id");b&&i==b&&a(this).find(".selimgtxtbtn").text("取消选择")})}}},complete:function(){var b=a.getPageBar(d.$curPage,d.$totalPage,d.$total);d.$pagecontent.html(b)},error:function(){d.$contentlist.html("<div class='datawarn'>数据加载失败</div>"),d.$pagecontent.hide()}})},ajaxpagemainlist:function(b){var c=this;c.$pagebtn.live("click",function(){var d=a(this).attr("rel");d&&c.getplugmainlist(d,b)})},execSearch:function(b){var c=this;if(""==a.trim(b))return alert("查询条件不能为空"),!1;b=a.trim(b);var d=c.$getpicnews+"?title="+encodeURIComponent(b);c.plugslistinit(d)},backimgtxtinfo:function(b,c){var d=this,e=d.$ele,f=!0;f&&a.ajax({type:"POST",url:d.$getwxreply,data:{id:b},success:function(a){f=!1,d.options.backdatainfo(e,d.$listdata_obj,a),d.hide()}})},checkedEle:function(b,c,d,e){var f=this;if("取消选择"==b.html()){b.html("选择");var g=b.attr("data-id");a.removeItem(d,g,"id")}else 0==e?(b.html("取消选择"),-1==jQuery.inArray(c,d)&&d.push(c)):d.length<e?(b.html("取消选择"),-1==jQuery.inArray(c,d)&&d.push(c)):alert("您最多选择"+e+"个");f.$multiselectnum.html("("+f.$listdata_arr.length+")")},bindEvent:function(){var b=this,c=b.$ele;b.$refreshbtn.die(),b.$refreshbtn.live("click",function(){b.$searchinput&&b.$searchinput.val(""),b.initdata()}),b.$searchbtn&&(b.$searchbtn.die(),b.$searchbtn.live("click",function(){var c=a(this).prev(".prd_k").val();b.execSearch(c)}),b.$searchinput.live("keyup change",function(c){var d=a(this).val(),d=a.trim(d);d&&a.hilightEle(b.$contentlist,d),13==c.keyCode&&b.execSearch(d)})),b.$tabnav.undelegate(),b.$tabnav.delegate("li","click",function(){var d=a(this).attr("data-mark"),e=a("#"+d+"List").find("table").length,f=a("#"+d+"List").find(".datawarn").length;c.attr("data-classfiy",d),0>=e&0>=f?b.initdata():(b.$contentlist=b.$modalHTML.find("#"+d+"List"),b.$pagecontent=b.$modalHTML.find("#"+d+"_imgtxt .prdpagecount"),b.$pagebtn=b.$modalHTML.find("#"+d+"_imgtxt .prdpagecount span a"))}),a.isFunction(b.options.backdatainfo)&&(b.$singleconfirmbtn.die(),b.$singleconfirmbtn.live("click",function(){var d=a(this),e=d.attr("data-id"),f=d.attr("data-title"),g=d.attr("data-type"),h=decodeURIComponent(d.attr("data-info")),i=b.$tabs_typetitle[g];if(h=JSON.parse(h),b.$listdata_obj={id:e,title:f,type:g,typeinfo:i,info:h},1==b.options.num){if(1!=b.options.isbackimgtxt)return b.options.backdatainfo(c,b.$listdata_obj),b.hide(),!1;b.backimgtxtinfo(e,b.$listdata_obj)}else b.checkedEle(d,b.$listdata_obj,b.$listdata_arr,b.options.num)}),1!==b.options.num&&(b.$multiselectbtn.unbind(),b.$multiselectbtn.bind("click",function(){for(var a="",d=0;d<b.$listdata_arr.length;d++)a+=b.$listdata_arr[d].id+",";c.attr("data-ids",a),b.options.backdatainfo(c,b.$listdata_arr)!==!1&&b.hide()})))}};var e=a.fn[b];a.fn[b]=function(c){return this.each(function(){var e=a(this),f=e.data("selectPlugsData"),g=a.fn[b].pluginData[f],h="object"==typeof c&&c;g||(f=a.fn[b].pluginData.index++,a.fn[b].pluginData[f]=new d(this,h),e.data("selectPlugsData",f),g=a.fn[b].pluginData[f]),g.creatnav().editimgtxtid().initdata().show().bindEvent()})},a.fn[b].pluginData={index:0},a.fn[b].Constructor=b,a.fn[b].noConflict=function(){return a.fn[b]=e,this},a(document).ready(function(){a('[data-plug="'+b+'"]').each(function(){var c=a(this),d=this.dataset;a.fn[b].call(c,d)})}),d.version="1.0.0"}($);
!function(a){var b="selectLink",c={host:"",allTabs:["normal","classify","goods","magazine","local"],magnum:"-1",diymag:0,backdatainfo:function(){}},d=function(b,d){this.$ele=a(b),this.options=a.extend({},c,d),this.init()};d.prototype={initDom:function(){return this.$total="",this.$totalPage="",this.$curPage=1,this.$listdata_obj="",this.$listdata_arr=[],this.$postUrl=this.options.host+"/index.php/shangjia/commoncomponent/getallprd?platform=2",this.$getactprd=this.options.host+"/index.php/shangjia/commoncomponent/getallprdactinfo?platform=2",this.$getscoreprd=this.options.host+"/index.php/shangjia/commoncomponent/getscorechangeprds?platform=2",this.$noraml_linkurl=this.options.host+"/index.php/shangjia/commoncomponent/getlinkurl?platform=2",this.$itemList=this.options.host+"/index.php/shangjia/commoncomponent/getcatslist?platform=2",this.$goodslink=this.options.host+"/index.php/shangjia/commoncomponent/getgoodslink?platform=2",this.$magazineurl=this.options.host+"/index.php/shangjia/commoncomponent/getmagazineurl?platform=2&mgz_type="+this.options.diymag,this.$getmagbyids=this.options.host+"/index.php/shangjia/commoncomponent/getoptmasstemp",this.$agentsurl=this.options.host+"/index.php/shangjia/commoncomponent/getfxwxmenulink",this.$tabs_title={normal:"常用连接",classify:"商品分类链接",goods:"商品链接",magazine:"微杂志连接",local:"自定义连接",agent:"分销链接"},this},init:function(){return this.initDom().create(),this},create:function(){var b=this,c=[];c[0]='<div id="UrlModal" class="modal hide fade" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-header" style="padding-bottom: 0;border-bottom: none;"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button><ul class="nav nav-tabs tabnavs" style="margin:0;"></ul></div><div class="modal-body"><div class="tab-content tabcontent"></div></div><div class="modal-footer"><button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button><button class="btn btn-primary UrlSubmitBtn">确定<span class="num"></span></button></div></div>';var d=a("body").find("#UrlModal").length;return 0>=d&&a(document.body).append(c[0]),b.$modalHTML=a("body").find("#UrlModal"),b.$tabnav=b.$modalHTML.find(".tabnavs"),b.$tabcontent=b.$modalHTML.find(".tabcontent"),this},creatnav:function(){for(var b=this,c="",d="",e=b.options.allTabs,f=0;f<e.length;f++)c+='<li data-mark="'+e[f]+'"><a href="#'+e[f]+'_link" data-toggle="tab">'+b.$tabs_title[e[f]]+"</a></li>";return-1!==e.indexOf("normal")&&(d+='<div class="tab-pane active linkbox scrollbar" id="normal_link"></div>'),-1!==e.indexOf("classify")&&(d+='<div class="tab-pane linkbox scrollbar" id="classify_link"></div>'),-1!==e.indexOf("goods")&&(d+='<div class="tab-pane" id="goods_link"><div class="mod-searchprd" style="margin-bottom: 10px;"><input type="text"  placeholder="商品标题" name="prdlink_k" class="prd_k"/><button class="btn j-search">查询</button></div><div id="assortlist" class="fl scrollbar m-body-l"></div><div class="fl m-body-c"><div id="prdLinklist" class="scrollbar linkbox modalprdlists"></div><div class="prdpagecount"></div></div></div>'),-1!==e.indexOf("magazine")&&(d+='<div class="tab-pane" id="magazine_link"><div style="margin-bottom: 10px;"><input type="text" placeholder="微杂志标题" name="mag_k" class="prd_k"/><button class="btn j-search">查询</button><button class="btn btn-primary fr refreshbtn">返回列表</button><button class="btn fr refreshbtn">刷新</button></div><div id="magazineList" class="scrollbar linkbox"></div><div class="prdpagecount"></div></div>'),-1!==e.indexOf("local")&&(d+='<div class="tab-pane" id="local_link"><input type="text" class="locallinkadd" placeholder="输入链接" style="width:400px!important;"><span class="btn confirmgetlink diyurl mlr05" data-url="" data-title="自定义链接">添加</span><p class="red" style="margin:10px 0 0 10px">提示：输入链接点击添加即可</p></div>'),-1!==e.indexOf("agent")&&(d+='<div class="tab-pane linkbox scrollbar" id="agent_link"></div>'),b.$tabnav.html(c),b.$tabcontent.html(d),b.$listdata_arr=[],a(".UrlSubmitBtn").find(".num").html(""),this},show:function(){return this.$modalHTML.modal("show"),this},hide:function(){return this.$modalHTML.modal("hide"),this},showsearchbox:function(){return a("#goods_link .mod-searchprd").find(".prd_k").removeAttr("disabled"),a("#goods_link .mod-searchprd").find(".j-search").removeClass("disabled"),this},hidesearchbox:function(){return a("#goods_link .mod-searchprd").find(".prd_k").attr("disabled","disabled"),a("#goods_link .mod-searchprd").find(".j-search").addClass("disabled"),this},getcurrentmark:function(){var a=this.$ele.attr("data-classfiy");return a||(a=this.options.allTabs[0]),a},setDom:function(a){var b=this;switch(a){case"normal":case"classify":case"agent":b.$contentlist=b.$modalHTML.find("#"+a+"_link");break;case"goods":b.$contentlist=b.$modalHTML.find("#prdLinklist"),b.$pagecontent=b.$modalHTML.find("#"+a+"_link").find(".prdpagecount"),b.$pagebtn=b.$modalHTML.find("#"+a+"_link").find(".prdpagecount span a");break;case"magazine":b.$contentlist=b.$modalHTML.find("#magazineList"),b.$pagecontent=b.$modalHTML.find("#"+a+"_link").find(".prdpagecount"),b.$pagebtn=b.$modalHTML.find("#"+a+"_link").find(".prdpagecount span a")}return b.$searchinput=b.$modalHTML.find(".prd_k"),b.$searchbtn=b.$modalHTML.find(".j-search"),b.$refreshbtn=b.$modalHTML.find(".refreshbtn"),b.$singleconfirmbtn=b.$modalHTML.find(".confirmgetlink"),b.$magazineconfirmbtn=b.$modalHTML.find(".confirm_morelink"),this},initdata:function(){var a=this.getcurrentmark();return this.$tabnav.find("li[data-mark="+a+"]").addClass("active").siblings().removeClass("active"),this.$tabcontent.find("#"+a+"_link").addClass("active").siblings().removeClass("active"),this.setDom(a).getlinkbymark(a),this.editmagid(),this},editmagid:function(){var b=this,c=this.getcurrentmark();if("magazine"==c&&"-1"!==b.options.magnum){var d=b.$ele.attr("data-magids");if(d){var e=d.substr(d.length-1,1);","==e&&(d=d.substr(0,d.length-1)),b.$listdata_arr=b.idsajax(d),b.$listdata_arr&&a(".UrlSubmitBtn").find(".num").html("("+b.$listdata_arr.length+")")}}return this},getlinkbymark:function(a){var b=this;"normal"==a?b.getplugmainlist(b.$noraml_linkurl,a):"classify"==a?b.getplugmainlist(b.$itemList,a):"goods"==a?(b.plugslistinit(b.$postUrl+"&sale=1",a),b.itemlist()):"magazine"==a?b.plugslistinit(b.$magazineurl,a):"agent"==a&&b.getplugmainlist(b.$agentsurl,a)},idsajax:function(b){var c=this;return a.ajax({type:"POST",url:c.$getmagbyids,data:{ids:b},dataType:"json",async:!1,success:function(a){c.$listdata_arr=a}}),c.$listdata_arr},itemlist:function(){var b=this,c=a("#assortlist").find("li").length;0>=c&&a.ajax({type:"POST",url:b.$itemList,data:{sale:1},dataType:"json",async:!1,beforeSend:function(){a("#assortlist").append("<div id='loading'>加载中...</div>")},success:function(b){var c="",d="",e=b.info;a.each(e,function(b,d){c+='<li data-cid="'+d.cid+'" data-id="'+d.id+'" data-show="'+d.visible+'">'+d.listname+"<code>"+d.prd_count+"</code></li>",d.sub.length>0&&a.each(d.sub,function(a,b){c+='<li class="item_sub" data-cid="'+b.cid+'" data-id="'+b.id+'" data-show="'+b.visible+'">'+b.listname+"<code>"+b.prd_count+"</code></li>"})}),d='<ul><li data-cid="0" data-id="0" data-show="0" class="active">所有分类</li><li data-cid="zc" data-id="0" data-show="0" data-act="zc">众筹商品</li><li data-cid="jf" data-id="0" data-show="0" data-act="jf">'+credit_mark+"换购商品</li>"+c+"</ul>",a("#assortlist").html(d)}})},plugslistinit:function(a,b){this.$pagebtn.die("click"),this.getplugmainlist(a,b,1),this.ajaxpagemainlist(a,b)},getplugmainlist:function(b,c,d){var e=this;if(d)var f={page:d};else var f={};a.ajax({type:"POST",url:b,data:f,dataType:"json",beforeSend:function(){e.$contentlist.html("<div class='dataloading'>加载中...</div>"),e.$pagecontent&&e.$pagecontent.hide()},success:function(f){if("40001"==f.status)e.$contentlist.html("<div class='datawarn'>登陆超时，请<span class='btn-link' onclick='location.reload();'>刷新</span>页面重新登陆</div>"),e.$pagecontent&&e.$pagecontent.hide();else if(e.$contentlist.empty(),0==f.count)e.$contentlist.html("<div class='datawarn'>没有数据</div>"),e.$pagecontent&&e.$pagecontent.hide();else{e.$pagecontent&&f.countpage>1&&(e.$pagecontent.show(),e.$total=f.count,e.$totalPage=f.countpage,e.$curPage=d),b==e.$getactprd&&b==e.$getscoreprd&&"goods"==c&&e.$pagecontent.html('<div id="pagecount"><span>共'+f.count+"条数据</span></div>");var g=e.getplugmainhtml(f,c);if(e.$contentlist.html(g),e.$searchinput){e.$searchinput=e.$modalHTML.find("#"+c+"_link").find(".prd_k");var h=e.$searchinput.val();h=a.trim(h),a.hilightEle(e.$contentlist,h)}if("magazine"==c&&"-1"!==e.options.magnum){var i=e.$listdata_arr.length;if(i>0)for(var j=0;i>j;j++){var k=e.$listdata_arr[j].id;e.$contentlist.find("li").each(function(){var b=a(this).attr("data-id");k==b&&a(this).find(".confirm_morelink").attr("data-select","1").text("取消选择")})}}}},complete:function(){if(e.$pagecontent){var b=a.getPageBar(e.$curPage,e.$totalPage,e.$total);e.$pagecontent.html(b)}},error:function(){e.$contentlist.html("<div class='datawarn'>数据加载失败</div>"),e.$pagecontent&&e.$pagecontent.hide()}})},getplugmainhtml:function(b,c){var d=this,e="";switch(c){case"normal":var e='<ul><li><span class="linktitle">店铺首页链接</span><a href="javascript:void(0);" data-url="'+b.info.indexurl+'" data-title="店铺首页链接" class="btn-link confirmgetlink">选择</a></li><li><span class="linktitle">分类（分类页面）</span><a href="javascript:void(0);" data-url="'+b.info.catslistUrl+'" data-title="分类页面" class="btn-link confirmgetlink">选择</a></li><li><span class="linktitle">购物车</span><a href="javascript:void(0);" data-url="'+b.info.shoppingurl+'" data-title="购物车" class="btn-link confirmgetlink">选择</a></li><li><span class="linktitle">个人中心（订单页面）</span><a href="javascript:void(0);" data-url="'+b.info.personalurl+'" data-title="个人中心（订单页面）" class="btn-link confirmgetlink">选择</a></li><li><span class="linktitle">优惠券列表</span><a href="javascript:void(0);" data-url="'+b.info.couponurl+'" data-title="优惠券列表" class="btn-link confirmgetlink">选择</a></li><li><span class="linktitle">礼品中心</span><a href="javascript:void(0);" data-url="'+b.info.giftcenterurl+'" data-title="礼品中心" class="btn-link confirmgetlink">选择</a></li><li><span class="linktitle">'+credit_mark+'明细</span><a href="javascript:void(0);" data-url="'+b.info.crediturl+'" data-title="'+credit_mark+'明细" class="btn-link confirmgetlink">选择</a></li><li><span class="linktitle">余额明细</span><a href="javascript:void(0);" data-url="'+b.info.balanceurl+'" data-title="余额明细" class="btn-link confirmgetlink">选择</a></li><li><span class="linktitle">红包</span><a href="javascript:void(0);" data-url="'+b.info.redpacketurl+'" data-title="红包" class="btn-link confirmgetlink">选择</a></li><li><span class="linktitle">返回上一页（选择后点击可返回上一页）</span><a href="javascript:void(0);" data-url="javascript:history.go(-1);" data-title="返回上一页" class="btn-link confirmgetlink">选择</a></li></ul>';break;case"classify":var f="",g=b.info,e="";a.each(g,function(b,c){f+='<li data-id="'+c.cid+'"><span class="linktitle">'+c.listname+"</span><code>"+c.prd_count+'</code><a href="javascript:void(0);" data-url="'+c.cats_link+'" data-title="'+c.listname+'" data-id="'+c.id+'" class="btn-link confirmgetlink">选择</a></li>',c.sub.length>0&&a.each(c.sub,function(a,b){f+='<li class="item_sub" data-id="'+b.cid+'"><span class="linktitle">'+b.listname+"</span><code>"+b.prd_count+'</code><a href="javascript:void(0);" data-url="'+b.cats_link+'" data-title="'+b.listname+'" data-id="'+b.id+'" class="btn-link confirmgetlink">选择</a></li>'})}),e="<ul>"+f+"</ul>";break;case"magazine":var f="",g=b.info,e="";a.each(g,function(a,b){var c=b.share_content&&b.share_content.shareimg?b.share_content.shareimg:"",e=b.share_content&&b.share_content.sharecontent?b.share_content.sharecontent:"";f+='<li data-id="'+b.id+'"><span class="linktitle">'+b.title+'</span><a href="javascript:void(0);" data-url="'+b.magurl+'" data-id="'+b.id+'"data-img="'+c+'" data-sharecon="'+e+'"',f+="-1"!==d.options.magnum?' class="btn-link confirm_morelink">选择</a></li>':' class="btn-link confirmgetlink">选择</a></li>'}),e="<ul>"+f+"</ul>";break;case"goods":var f="",g=b.info,e="";a.each(g,function(a,b){f+='<li data-id="'+b.id+'" id="a'+b.id+'"><a href="javascript:void(0);" class="prdinfo"><div class="pic"><img src="'+b.pic_url+'_180x180.jpg"/></div><div class="prd-des"><p class="title linktitle">'+b.title+'</p><div><p class="price fl" price="'+b.price+'">￥'+b.price+'</p></div></div><div class="confirmgetlink" data-url="'+b.prd_url+'" data-title="'+b.title+'" data-id="'+b.id+'"><span class="btn">选择</span></div></a></li>'}),e="<ul>"+f+"</ul>";break;case"agent":var f="",g=b.data,e="";a.each(g,function(a,b){f+='<li><span class="linktitle">'+b.title+'</span><a href="javascript:void(0);" data-title="'+b.title+'" data-url="'+b.link+'" class="btn-link confirmgetlink">选择</a></li>'}),e="<ul>"+f+"</ul>"}return e},ajaxpagemainlist:function(b,c){var d=this;d.$pagebtn.live("click",function(){var e=a(this).attr("rel");e&&d.getplugmainlist(b,c,e)})},execSearch:function(b){var c=this;if(""==a.trim(b))return alert("查询条件不能为空"),!1;b=a.trim(b);var d=c.getcurrentmark();if("magazine"==d){var e=c.$magazineurl+"&title="+encodeURIComponent(b);c.plugslistinit(e,d)}else if("goods"==d){var f=a("#assortlist").find("li.active").attr("data-cid");0==f?c.plugslistinit(c.$postUrl+"&sale=1&title="+encodeURIComponent(b),d):c.plugslistinit(c.$goodslink+"&sale=1&classifyid="+f+"&title="+encodeURIComponent(b),d)}},getlinkarr:function(a,b,c){if(a=a?a:"",b=b?b:"",c=c?c:"",a)var d={id:a,title:b,url:c};else var d={title:b,url:c};return d},linkmatch:function(a){var b=a.match(/^(http|https):\/\/.+/);return null==b?!1:!0},bindEvent:function(){var b=this,c=b.$ele;b.$refreshbtn.die(),b.$refreshbtn.live("click",function(){b.$searchinput&&b.$searchinput.val("");var a=b.getcurrentmark();b.getlinkbymark(a)}),b.$tabnav.undelegate(),b.$tabnav.delegate("li","click",function(){var d=a(this).attr("data-mark");b.setDom(d),"goods"==d?b.$pagecontent.show():"magazine"==d&&b.$pagecontent.show();var e=b.$contentlist.find("ul").length;c.attr("data-classfiy",d),e||b.getlinkbymark(d)}),b.$searchbtn&&(b.$searchbtn.die(),b.$searchbtn.live("click",function(){var c=a(this).prev(".prd_k").val();b.execSearch(c)}),b.$searchinput.live("keyup change",function(c){var d=a(this).val(),d=a.trim(d);d&&a.hilightEle(b.$contentlist,d),13==c.keyCode&&b.execSearch(d)})),a("#assortlist").undelegate(),a("#assortlist").delegate("li","click",function(c){var d=a(this),e=d.attr("data-cid"),f="goods";0==e?(b.showsearchbox(),b.plugslistinit(b.$postUrl+"&sale=1",f)):"zc"==e?(b.hidesearchbox(),b.getplugmainlist(b.$getactprd,f)):"jf"==e?(b.hidesearchbox(),b.getplugmainlist(b.$getscoreprd,f)):(b.showsearchbox(),b.plugslistinit(b.$goodslink+"&sale=1&classifyid="+e,f)),d.parent().children("li").removeClass("active"),d.addClass("active")}),a(".locallinkadd").live("keyup change",function(c){var d=a(this).val();a(this).next().attr("data-url",d),13==event.keyCode&&(b.linkmatch(d)||(alert("您输入的链接无效，请重新输入"),a(".locallinkadd").val("").focus()))}),a.isFunction(b.options.backdatainfo)&&(b.$singleconfirmbtn.die(),b.$singleconfirmbtn.live("click",function(){var d=a(this),e=d.attr("data-id"),f=d.parents("li").find(".linktitle").text(),g=d.attr("data-url");if(d.hasClass("diyurl")){if(!b.linkmatch(g))return alert("您输入的链接无效，请重新输入"),a(".locallinkadd").val("").focus(),!1;f="自定义链接"}b.$listdata_obj=b.getlinkarr(e,f,g),b.options.backdatainfo(c,b.$listdata_obj),b.hide()}),b.$magazineconfirmbtn.die(),b.$magazineconfirmbtn.live("click",function(){var c=a(this),d=c.attr("data-id"),e=c.parents("li").find(".linktitle").text(),f=c.attr("data-img"),g=c.attr("data-sharecon"),h=c.attr("data-url");if(d=d?d:"",b.$listdata_obj={id:d,title:e,img:f,subtitle:g,url:h},"1"==c.attr("data-select"))a.removeItem(b.$listdata_arr,d,"id"),c.attr("data-select","0").html("选择");else{if(parseInt(b.$listdata_arr.length)==parseInt(b.options.magnum)&&parseInt(b.options.magnum)>0)return alert("只能选择"+b.options.magnum+"条连接"),!1;b.$listdata_arr.push(b.$listdata_obj),c.attr("data-select","1").html("取消选择")}a(".UrlSubmitBtn").find(".num").html("("+b.$listdata_arr.length+")")}),a("#UrlModal .modal-footer").undelegate(),a("#UrlModal .modal-footer").delegate(".UrlSubmitBtn","click",function(){var a=b.getcurrentmark();if(b.options.magnum>-1&&"magazine"==a){if(!(b.$listdata_arr.length>0))return alert("请选择微杂志连接"),!1;b.options.backdatainfo(c,b.$listdata_arr),b.hide()}else b.hide()}))}};var e=a.fn[b];a.fn[b]=function(c){return this.each(function(){var e=a(this),f=e.data("selectPlugsData"),g=a.fn[b].pluginData[f],h="object"==typeof c&&c;g||(f=a.fn[b].pluginData.index++,a.fn[b].pluginData[f]=new d(this,h),e.data("selectPlugsData",f),g=a.fn[b].pluginData[f]),g.creatnav().initdata().show().bindEvent()})},a.fn[b].pluginData={index:0},a.fn[b].Constructor=b,a.fn[b].noConflict=function(){return a.fn[b]=e,this},a(document).ready(function(){a('[data-plug="'+b+'"]').each(function(){var c=a(this),d=this.dataset;a.fn[b].call(c,d)})}),d.version="1.0.0"}($);
!function($){var pluginName="selectmessTemp",defaults={host:"",isbackinfo:1,backdatainfo:function(){}},SelectmessTemp=function(a,b){this.$ele=$(a),this.options=$.extend({},defaults,b),this.init()};SelectmessTemp.prototype={$tempname:{OPENTM200731494:"活动参与成功通知",OPENTM200449454:"签到提醒",TM00335:credit_mark+"提醒",TM00575:"报名成功通知",OPENTM201477957:"赞助提醒",TM00772:credit_mark+"交易提醒",TM00851:"优惠券到账通知",OPENTM200772305:"礼品领取成功通知",OPENTM200681949:"红包领取提醒",OPENTM201010447:"订单代付成功提醒",OPENTM201908937:"众筹项目状态变更通知",OPENTM201225366:"预约活动开始提醒",OPENTM202243887:"优惠券使用通知"},initDom:function(){return this.$total="",this.$totalPage="",this.$curPage=1,this.$listdata_obj="",this.$getallmesslist=this.options.host+"/index.php/shangjia/commoncomponent/selectmasstemp",this.$getmesstempinfo=this.options.host+"/index.php/shangjia/wxmass/previewmesstemplate",this.$creatnewurl=this.options.host+"/index.php/shangjia/wxmass/messtemplatelist",this},init:function(){return this.initDom().create().initdata().bindEvent(),this},create:function(){var a=this,b=[];b[0]='<div id="MyMessTempModal" class="modal hide fade" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button><h3>选择消息模板<a href="'+a.$creatnewurl+'" class="btn btn-success fr mlr05" target="_blank">新建消息模板</a></h3></div><div class="modal-body"><div class="scrollbar linkbox" id="mymesstemplist"></div><div class="prdpagecount"></div></div><div class="modal-footer"><button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button></div></div>';var c=$("body").find("#MyFromModal").length;return 0>=c&&$(document.body).append(b[0]),a.$modalHTML=$("body").find("#MyMessTempModal"),a.setDom(),this},setDom:function(){return this.$contentlist=this.$modalHTML.find("#mymesstemplist"),this.$singleconfirmbtn=this.$modalHTML.find(".seltempbtn"),this.$pagecontent=this.$modalHTML.find(".prdpagecount"),this.$pagebtn=this.$modalHTML.find(".prdpagecount span a"),this},show:function(){return this.$modalHTML.modal("show"),this},hide:function(){return this.$modalHTML.modal("hide"),this},initdata:function(){return this.plugslistinit(this.$getallmesslist),this},plugslistinit:function(a){this.$pagebtn.die("click"),this.getplugmainlist(1,a),this.ajaxpagemainlist(a)},getplugmainhtml:function(a){var b="",c='<table style="width:100%;"><tr><th>名称</th><th>类型</th><th width="">创建时间</th><th width="">操作</th></tr>',d="",e=a.result;$.each(e,function(a,b){d+='<tr data-id="'+b.id+'"><td><span class="temp_title" title="'+b.title+'">'+b.title+'</span></td><td data-number="'+b.number+'">'+b.info.title+"</td><td>"+b.creat_date+'</td><td><a href="javascript:void(0);" class="btn-link seltempbtn" data-id="'+b.id+'" data-title="'+b.title+'" data-number="'+b.number+'">选择</a></td></tr>'});var f="</table>";return b=c+d+f},getplugmainlist:function(a,b){var c=this;$.ajax({type:"POST",url:b,data:{page:a},dataType:"json",beforeSend:function(){c.$contentlist.html("<div class='dataloading'>加载中...</div>"),c.$pagecontent.hide()},success:function(b){if("40001"==b.status)c.$contentlist.html("<div class='datawarn'>登陆超时，请<span class='btn-link' onclick='location.reload();'>刷新</span>页面重新登陆</div>"),c.$pagecontent.hide();else if(c.$contentlist.empty(),0==b.countpage)c.$contentlist.html("<div class='datawarn'>没有数据</div>"),c.$pagecontent.hide();else{b.countpage>1&&(c.$pagecontent.show(),c.$total=b.count,c.$totalPage=b.countpage,c.$curPage=a);var d=c.getplugmainhtml(b);c.$contentlist.html(d)}},complete:function(){var a=$.getPageBar(c.$curPage,c.$totalPage,c.$total);c.$pagecontent.html(a)},error:function(){c.$contentlist.html("<div class='datawarn'>数据加载失败</div>"),c.$pagecontent.hide()}})},ajaxpagemainlist:function(a){var b=this;b.$pagebtn.live("click",function(){var c=$(this).attr("rel");c&&b.getplugmainlist(c,a)})},previewtemp:function(id,number,obj){var _this=this,ele=_this.$ele,flag=!0;flag&&$.ajax({type:"POST",url:_this.$getmesstempinfo,data:{id:id,number:number},success:function(json){var o=eval("("+json+")"),e=o.info,myDate=new Date,month=myDate.getMonth()+1;day=myDate.getDate();var str="<div class='info-cont'><div style='background-color:"+e.topcolor+";height:12px;'></div><div class='info-div'><h2>"+_this.$tempname[number]+"</h2><p class='info-data gray'>"+month+"月"+day+"日</p><p class='info-p blue' style='color:"+e.first.color+"'>"+e.first.value+"</p>";1==o.mark?(str=str+"<p class='info-p'>活动名：<span class='blue' style='color:"+e.keyword1.color+"'>"+e.keyword1.value+"</span></p>",str=str+"<p class='info-p'>参加时间：<span class='blue' style='color:"+e.keyword2.color+";'>"+e.keyword2.value+"</span></p>"):2==o.mark?(str=str+"<p class='info-p'>奖励"+credit_mark+"：<span class='blue' style='color:"+e.keyword1.color+"'>"+e.keyword1.value+"</span></p>",str=str+"<p class='info-p'>会员"+credit_mark+"：<span class='blue' style='color:"+e.keyword2.color+";'>"+e.keyword2.value+"</span></p>"):3==o.mark?(str=str+"<p class='info-p'>账户：<span class='blue' id='J_account' style='color:"+e.account.color+"'>"+e.account.value+"</span></p>",str=str+"<p class='info-p'>时间：<span class='blue' id='J_date' style='color:"+e.time.color+"'>"+e.time.value+"</span></p>",str=str+"<p class='info-p'>类型：<span class='blue' id='J_type' style='color:"+e.type.color+"'>"+e.type.value+"</span></p>",str=str+"<p class='info-p'><span class='blue' id='J_creditChange' style='color:"+e.creditChange.color+"'>"+e.creditChange.value+"</span>"+credit_mark+"：<span class='blue' id='J_integral' style='color:"+e.number.color+"'>"+e.number.value+"</span></p>",str=str+"<p class='info-p'><span class='blue' id='J_creditName' style='color:"+e.creditName.color+"'>"+e.creditName.value+"</span>余额：<span class='blue' id='J_balance' style='color:"+e.amount.color+"'>"+e.amount.value+"</span></p>"):4==o.mark?(str=str+"<p class='info-p'>活动主题：<span class='blue' id='J_aname' style='color:"+e.keynote1.color+"'>"+e.keynote1.value+"</span></p>",str=str+"<p class='info-p'>活动时间：<span class='blue' id='J_date' style='color:"+e.keynote2.color+"'>"+e.keynote2.value+"</span></p>",str=str+"<p class='info-p'>活动地点：<span class='blue' id='J_place' style='color:"+e.keynote3.color+"'>"+e.keynote3.value+"</span></p>"):5==o.mark?(str=str+"<p class='info-p'>昵称：<span class='' id='J_aname' style='color:"+e.keyword1.color+"'>"+e.keyword1.value+"</span></p>",str=str+"<p class='info-p'>赞助金额：<span class='' id='J_monay' style='color:"+e.keyword2.color+"'>"+e.keyword2.value+"</span></p>",str=str+"<p class='info-p'>留言：<span class='' id='J_place' style='color:"+e.keyword3.color+"'>"+e.keyword3.value+"</span></p>",str=str+"<p class='info-p'>时间：<span class='' id='J_date' style='color:"+e.keyword4.color+"'>"+e.keyword4.value+"</span></p>"):6==o.mark?(str=str+"<p class='info-p'>交易时间：<span class='blue' id='J_date' style='color:"+e.time.color+"'>"+e.time.value+"</span></p>",str=str+"<p class='info-p'>交易类型：<span class='blue' id='J_type' style='color:"+e.type.color+"'>"+e.type.value+"</span></p>",str=str+"<p class='info-p'>交易"+credit_mark+"：<span class='blue' id='J_jf' style='color:"+e.Point.color+"'>"+e.Point.value+"</span></p>",str=str+"<p class='info-p'>交易来源：<span class='blue' id='J_source' style='color:"+e.From.color+"'>"+e.From.value+"</span></p>"):7==o.mark?(str=str+'<p class="info-p">适用范围：<span class="blue" id="J_range" style="color:'+e.orderTicketStore.color+'">'+e.orderTicketStore.value+"</span></p>",str=str+'<p class="info-p">使用规则：<span class="blue" id="J_rule" style="color:'+e.orderTicketRule.color+'">'+e.orderTicketRule.value+"</span></p>"):8==o.mark?(str=str+'<p class="info-p">领取人：<span class="blue" id="J_name" style="color:'+e.keyword1.color+'">'+e.keyword1.value+"</span></p>",str=str+'<p class="info-p">礼品：<span class="blue" id="J_gift" style="color:'+e.keyword2.color+'">'+e.keyword2.value+"</span></p>",str=str+'<p class="info-p">领取时间：<span class="blue" id="J_date" style="color:'+e.keyword3.color+'">'+e.keyword3.value+"</span></p>"):9==o.mark?(str=str+'<p class="info-p">领取金额：<span class="blue" id="J_monay" style="color:'+e.keyword1.color+'">'+e.keyword1.value+"</span></p>",str=str+'<p class="info-p">领取时间：<span class="blue" id="J_date" style="color:'+e.keyword2.color+'">'+e.keyword2.value+"</span></p>"):10==o.mark?(str=str+'<p class="info-p">代付人：<span class="blue" id="J_name" style="color:'+e.keyword1.color+'">'+e.keyword1.value+"</span></p>",str=str+'<p class="info-p">订单号：<span class="blue" id="J_num" style="color:'+e.keyword2.color+'">'+e.keyword2.value+"</span></p>",str=str+'<p class="info-p">商品：<span class="blue" id="J_goods" style="color:'+e.keyword3.color+'">'+e.keyword3.value+"</span></p>",str=str+'<p class="info-p">金额：<span class="blue" id="J_monay" style="color:'+e.keyword4.color+'">'+e.keyword4.value+"</span></p>"):11==o.mark?(str=str+'<p class="info-p">项目名称：<span class="blue" id="J_name" style="color:'+e.keyword1.color+'">'+e.keyword1.value+"</span></p>",str=str+'<p class="info-p">项目结束时间：<span class="blue" id="J_date" style="color:'+e.keyword2.color+'">'+e.keyword2.value+"</span></p>",str=str+'<p class="info-p">项目支持人数上限：<span class="blue" id="J_max" style="color:'+e.keyword3.color+'">'+e.keyword3.value+"</span></p>"):12==o.mark?(str=str+'<p class="info-p">预约活动：<span class="blue" id="J_name" style="color:'+e.keyword1.color+'">'+e.keyword1.value+"</span></p>",str=str+'<p class="info-p">开始时间：<span class="blue" id="J_date" style="color:'+e.keyword2.color+'">'+e.keyword2.value+"</span></p>"):13==o.mark&&(str=str+'<p class="info-p">优惠券名称：<span class="blue" id="J_name" style="color:'+e.keyword1.color+'">'+e.keyword1.value+"</span></p>",str=str+'<p class="info-p">使用店铺：<span class="blue" id="J_date" style="color:'+e.keyword2.color+'">'+e.keyword2.value+"</span></p>",str=str+'<p class="info-p">使用时间：<span class="blue" id="J_date" style="color:'+e.keyword3.color+'">'+e.keyword3.value+"</span></p>"),str+='<p class="info-p blue" id="J_detail" style="color:'+e.remark.color+'">'+e.remark.value+'</p><p class="info-link">详情<span class="icon-chevron-right fr"></span></p></div>',flag=!1,_this.options.backdatainfo(ele,obj,str),_this.hide()}})},bindEvent:function(){var a=this,b=a.$ele;$.isFunction(a.options.backdatainfo)&&(a.$singleconfirmbtn.die(),a.$singleconfirmbtn.live("click",function(){var c=$(this),d=c.attr("data-id"),e=c.attr("data-title"),f=c.attr("data-number");a.$listdata_obj={id:d,title:e,number:f},a.options.isbackinfo?a.previewtemp(d,f,a.$listdata_obj):(a.options.backdatainfo(b,a.$listdata_obj),a.hide())}))}};var old=$.fn[pluginName];$.fn[pluginName]=function(a){return this.each(function(){var b=$(this),c=b.data("selectPlugsData"),d=$.fn[pluginName].pluginData[c],e="object"==typeof a&&a;d||(c=$.fn[pluginName].pluginData.index++,$.fn[pluginName].pluginData[c]=new SelectmessTemp(this,e),b.data("selectPlugsData",c),d=$.fn[pluginName].pluginData[c]),d.show()})},$.fn[pluginName].pluginData={index:0},$.fn[pluginName].Constructor=pluginName,$.fn[pluginName].noConflict=function(){return $.fn[pluginName]=old,this},$(document).ready(function(){$('[data-plug="'+pluginName+'"]').each(function(){var a=$(this),b=this.dataset;$.fn[pluginName].call(a,b)})}),SelectmessTemp.version="1.0.0"}($);
!function(a){var b="selectRedPacket",c={host:"",allTabs:["balance","share"],backdatainfo:function(){}},d=function(b,d){this.$ele=a(b),this.options=a.extend({},c,d),this.init()};d.prototype={initDom:function(){return this.$total="",this.$totalPage="",this.$curPage=1,this.$listdata_obj="",this.$getrpacket=this.options.host+"/index.php/shangjia/commoncomponent/shoprpacket?page_size=10",this.$creatnewurl=this.options.host+"/index.php/shangjia/activity/redbagnew",this.$tabs_title={balance:"店铺礼金",share:"微信红包"},this.$tabs_type={balance:"1",share:"2"},this.$tabs_typetitle={1:"店铺礼金",2:"微信红包"},this},init:function(){return this.initDom().create().bindEvent(),this},create:function(){var b=this,c=[];c[0]='<div id="myRpacketModal" class="modal hide fade" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button><h3 class="fl">选择红包</h3><a href="'+b.$creatnewurl+'" class="btn btn-success fr" target="_blank" style="margin-right:20px;">新建红包</a><span class="btn fr refreshbtn">刷新</span><div class="clearfix"></div></div><div class="modal-body"><div class="tabbable tabs-left"><ul class="nav nav-tabs tabnavs"></ul><div class="tab-content tabcontent"></div></div></div><div class="modal-footer"><button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button></div></div>';var d=a("body").find("#myRpacketModal").length;return 0>=d&&a(document.body).append(c[0]),b.$modalHTML=a("body").find("#myRpacketModal"),b.setDom(),this},creatnav:function(){for(var a=this,b="",c="",d=a.options.allTabs,e=0;e<d.length;e++)b+='<li data-mark="'+d[e]+'"><a href="#red'+d[e]+'_list" data-toggle="tab">'+a.$tabs_title[d[e]]+"</a></li>",-1!==d.indexOf(d[e])&&(c+='<div class="tab-pane myrpacketlist" id="red'+d[e]+'_list"><div id="my'+d[e]+'List" class="scrollbar linkbox"></div><div class="prdpagecount"></div></div>');return a.$modalHTML.find(".tabnavs").html(b),a.$modalHTML.find(".tabcontent").html(c),this},setDom:function(){return this.$refreshbtn=this.$modalHTML.find(".refreshbtn"),this.$tabnav=this.$modalHTML.find(".tabnavs"),this.$tabcontent=this.$modalHTML.find(".tabcontent"),this.$singleconfirmbtn=this.$modalHTML.find(".selrpacketbtn"),this.$searchinput&&this.$searchinput.val(""),this},show:function(){return this.$modalHTML.modal("show"),this},hide:function(){return this.$modalHTML.modal("hide"),this},getcurrentmark:function(){var a=this.$ele.attr("data-classfiy");return a||(a=this.options.allTabs[0]),a},initdata:function(){var a=this.getcurrentmark();return this.$tabnav.find("li[data-mark="+a+"]").addClass("active").siblings().removeClass("active"),this.$tabcontent.find("#red"+a+"_list").addClass("active").siblings().removeClass("active"),this.$contentlist=this.$modalHTML.find("#my"+a+"List"),this.$pagecontent=this.$modalHTML.find("#red"+a+"_list .prdpagecount"),this.$pagebtn=this.$modalHTML.find("#red"+a+"_list .prdpagecount span a"),this.plugslistinit(this.$getrpacket+"&type="+this.$tabs_type[a]),this},plugslistinit:function(a){this.$pagebtn.die("click"),this.getplugmainlist(1,a),this.ajaxpagemainlist(a)},getplugmainhtml:function(b){var c="",d='<table style="width:100%;"><tr><th>红包名称</th><th>红包类型</th><th>发放数量</th><th>红包预算</th><th width="60">操作</th></tr>',e="",f=b.result;a.each(f,function(a,b){e+='<tr data-id="'+b.id+'"><td><span class="rpacket_title" title="'+b.r_name+'">'+b.r_name+"</span></td><td>"+b.rtype_chinese+"</td><td>"+b.rcount+"</td><td>"+b.r_budget+'</td><td><a href="javascript:void(0);" class="btn-link selrpacketbtn" data-id="'+b.id+'" data-title="'+b.r_name+'" data-value="'+b.r_budget+'" data-num="'+b.rcount+'" data-type="'+b.r_type+'" data-usetype="'+b.r_usetype+'">选择</a></td></tr>'});var g="</table>";return c=d+e+g},getplugmainlist:function(b,c){var d=this;a.ajax({type:"POST",url:c,data:{page:b},dataType:"json",beforeSend:function(){d.$contentlist.html("<div class='dataloading'>加载中...</div>"),d.$pagecontent.hide()},success:function(a){if("40001"==a.status)d.$contentlist.html("<div class='datawarn'>登陆超时，请<span class='btn-link' onclick='location.reload();'>刷新</span>页面重新登陆</div>"),d.$pagecontent.hide();else if(d.$contentlist.empty(),0==a.totalPage)d.$contentlist.html("<div class='datawarn'>没有数据</div>"),d.$pagecontent.hide();else{a.totalPage>1&&(d.$pagecontent.show(),d.$total=a.count,d.$totalPage=a.totalPage,d.$curPage=b);var c=d.getplugmainhtml(a);d.$contentlist.html(c)}},complete:function(){var b=a.getPageBar(d.$curPage,d.$totalPage,d.$total);d.$pagecontent.html(b)},error:function(){d.$contentlist.html("<div class='datawarn'>数据加载失败</div>"),d.$pagecontent.hide()}})},ajaxpagemainlist:function(b){var c=this;c.$pagebtn.live("click",function(){var d=a(this).attr("rel");d&&c.getplugmainlist(d,b)})},bindEvent:function(){var b=this,c=b.$ele;b.$refreshbtn.die(),b.$refreshbtn.live("click",function(){b.initdata()}),b.$tabnav.undelegate(),b.$tabnav.delegate("li","click",function(){var d=a(this).attr("data-mark"),e=a("#my"+d+"List").find("table").length,f=a("#my"+d+"List").find(".datawarn").length;c.attr("data-classfiy",d),0>=e&0>=f?b.initdata():(b.$contentlist=b.$modalHTML.find("#my"+d+"List"),b.$pagecontent=b.$modalHTML.find("#red"+d+"_list .prdpagecount"),b.$pagebtn=b.$modalHTML.find("#red"+d+"_list .prdpagecount span a"))}),a.isFunction(b.options.backdatainfo)&&(b.$singleconfirmbtn.die(),b.$singleconfirmbtn.live("click",function(){var d=a(this),d=a(this),e=d.attr("data-id"),f=d.attr("data-title"),g=d.attr("data-value"),h=d.attr("data-num"),i=d.attr("data-type"),j=d.attr("data-usetype");return b.$listdata_obj={id:e,title:f,value:g,num:h,type:i,usetype:j},b.options.backdatainfo(c,b.$listdata_obj),b.hide(),!1}))}};var e=a.fn[b];a.fn[b]=function(c){return this.each(function(){var e=a(this),f=e.data("selectPlugsData"),g=a.fn[b].pluginData[f],h="object"==typeof c&&c;g||(f=a.fn[b].pluginData.index++,a.fn[b].pluginData[f]=new d(this,h),e.data("selectPlugsData",f),g=a.fn[b].pluginData[f]),g.creatnav().initdata().show()})},a.fn[b].pluginData={index:0},a.fn[b].Constructor=b,a.fn[b].noConflict=function(){return a.fn[b]=e,this},a(document).ready(function(){a('[data-plug="'+b+'"]').each(function(){var c=a(this),d=this.dataset;a.fn[b].call(c,d)})}),d.version="1.0.0"}($);
!function(a){var b="selectwxMass",c={host:"",isbackimgtxt:0,allTabs:["single","double","voice"],backdatainfo:function(){}},d=function(b,d){this.$ele=a(b),this.options=a.extend({},c,d),this.init()};d.prototype={initDom:function(){return this.$total="",this.$totalPage="",this.$curPage=1,this.$listdata_obj="",this.$getpicnews=this.options.host+"/index.php/shangjia/commoncomponent/selectwxmass",this.$getwxreply=this.options.host+"/index.php/shangjia/wxmass/twshow",this.$creatnewurl=this.options.host+"/index.php/shangjia/chat/masslist",this.$tabs_title={single:"单图文","double":"多图文",voice:"语音消息"},this.$tabs_type={single:"2","double":"3",voice:"5"},this.$tabs_typetitle={2:"单图文",3:"多图文",5:"语音消息"},this},init:function(){return this.initDom().create().bindEvent(),this},create:function(){var b=this,c=[];c[0]='<div id="wxmassModal" class="modal hide fade" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button><h3>选择高级图文素材</h3><input type="text"  placeholder="图文素材标题" name="imgtxt_k" class="prd_k"/><button class="btn j-search">查询</button><a href="'+b.$creatnewurl+'" class="btn btn-success fr" target="_blank">新建图文</a><span class="btn fr refreshbtn">刷新</span></div><div class="modal-body"><div class="tabbable tabs-left"><ul class="nav nav-tabs tabnavs"></ul><div class="tab-content tabcontent"></div></div></div><div class="modal-footer"><button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button></div></div>';var d=a("body").find("#wxmassModal").length;return 0>=d&&a(document.body).append(c[0]),b.$modalHTML=a("body").find("#wxmassModal"),b.setDom(),this},creatnav:function(){for(var a=this,b="",c="",d=a.options.allTabs,e=0;e<d.length;e++)b+='<li data-mark="'+d[e]+'"><a href="#'+d[e]+'_mass" data-toggle="tab">'+a.$tabs_title[d[e]]+"</a></li>",-1!==d.indexOf(d[e])&&(c+='<div class="tab-pane imgtxtlists" id="'+d[e]+'_mass"><div id="'+d[e]+'masslist" class="scrollbar linkbox"></div><div class="prdpagecount"></div></div>');return a.$modalHTML.find(".tabnavs").html(b),a.$modalHTML.find(".tabcontent").html(c),this},setDom:function(){return this.$searchinput=this.$modalHTML.find(".prd_k"),this.$searchbtn=this.$modalHTML.find(".j-search"),this.$refreshbtn=this.$modalHTML.find(".refreshbtn"),this.$tabnav=this.$modalHTML.find(".tabnavs"),this.$tabcontent=this.$modalHTML.find(".tabcontent"),this.$singleconfirmbtn=this.$modalHTML.find(".selimgtxtbtn"),this.$searchinput&&this.$searchinput.val(""),this},show:function(){return this.$modalHTML.modal("show"),this},hide:function(){return this.$modalHTML.modal("hide"),this},getcurrentmark:function(){var a=this.$ele.attr("data-classfiy");return a||(a=this.options.allTabs[0]),a},initdata:function(){var a=this.getcurrentmark();return this.$tabnav.find("li[data-mark="+a+"]").addClass("active").siblings().removeClass("active"),this.$tabcontent.find("#"+a+"_mass").addClass("active").siblings().removeClass("active"),this.$contentlist=this.$modalHTML.find("#"+a+"masslist"),this.$pagecontent=this.$modalHTML.find("#"+a+"_mass .prdpagecount"),this.$pagebtn=this.$modalHTML.find("#"+a+"_mass .prdpagecount span a"),this.plugslistinit(this.$getpicnews+"?type="+this.$tabs_type[a]),this},plugslistinit:function(a){this.$pagebtn.die("click"),this.getplugmainlist(1,a),this.ajaxpagemainlist(a)},getplugmainhtml:function(b){var c="",d='<table style="width:100%;"><tr><th>名称</th><th width="35%">创建时间</th><th width="20%">操作</th></tr>',e="",f=b.result;a.each(f,function(a,b){e+='<tr data-id="'+b.id+'"><td><span class="imgtxt_title" title="'+b.name+'">'+b.name+"</span></td><td>"+b.creat_time+'</td><td><a href="javascript:void(0);" class="btn-link selimgtxtbtn" data-id="'+b.id+'" data-title="'+b.name+'" data-type="'+b.Articles_type+'">选择</a></td></tr>'});var g="</table>";return c=d+e+g},getplugmainlist:function(b,c){var d=this;a.ajax({type:"POST",url:c,data:{page:b},dataType:"json",beforeSend:function(){d.$contentlist.html("<div class='dataloading'>加载中...</div>"),d.$pagecontent.hide()},success:function(c){if("40001"==c.status)d.$contentlist.html("<div class='datawarn'>登陆超时，请<span class='btn-link' onclick='location.reload();'>刷新</span>页面重新登陆</div>"),d.$pagecontent.hide();else if(d.$contentlist.empty(),0==c.countpage)d.$contentlist.html("<div class='datawarn'>没有数据</div>"),d.$pagecontent.hide();else{c.countpage>1&&(d.$pagecontent.show(),d.$total=c.count,d.$totalPage=c.countpage,d.$curPage=b);var e=d.getplugmainhtml(c);d.$contentlist.html(e);var f=d.$searchinput.val();f=a.trim(f),a.hilightEle(d.$contentlist,f)}},complete:function(){var b=a.getPageBar(d.$curPage,d.$totalPage,d.$total);d.$pagecontent.html(b)},error:function(){d.$contentlist.html("<div class='datawarn'>数据加载失败</div>"),d.$pagecontent.hide()}})},ajaxpagemainlist:function(b){var c=this;c.$pagebtn.live("click",function(){var d=a(this).attr("rel");d&&c.getplugmainlist(d,b)})},execSearch:function(b){var c=this;if(""==a.trim(b))return alert("查询条件不能为空"),!1;b=a.trim(b);var d=c.$getpicnews+"?title="+encodeURIComponent(b);c.plugslistinit(d)},backimgtxtinfo:function(b,c){var d=this,e=d.$ele,f=!0;f&&a.ajax({type:"POST",url:d.$getwxreply,data:{id:b},success:function(a){f=!1,d.options.backdatainfo(e,d.$listdata_obj,a),d.hide()}})},bindEvent:function(){var b=this,c=b.$ele;b.$refreshbtn.die(),b.$refreshbtn.live("click",function(){b.$searchinput&&b.$searchinput.val(""),b.initdata()}),b.$searchbtn&&(b.$searchbtn.die(),b.$searchbtn.live("click",function(){var c=a(this).prev(".prd_k").val();b.execSearch(c)}),b.$searchinput.live("keyup change",function(c){var d=a(this).val(),d=a.trim(d);d&&a.hilightEle(b.$contentlist,d),13==c.keyCode&&b.execSearch(d)})),b.$tabnav.undelegate(),b.$tabnav.delegate("li","click",function(){var d=a(this).attr("data-mark"),e=a("#"+d+"masslist").find("table").length,f=a("#"+d+"masslist").find(".datawarn").length;c.attr("data-classfiy",d),0>=e&0>=f?b.initdata():(b.$contentlist=b.$modalHTML.find("#"+d+"masslist"),b.$pagecontent=b.$modalHTML.find("#"+d+"_mass .prdpagecount"),b.$pagebtn=b.$modalHTML.find("#"+d+"_mass .prdpagecount span a"))}),a.isFunction(b.options.backdatainfo)&&(b.$singleconfirmbtn.die(),b.$singleconfirmbtn.live("click",function(){var d=a(this),e=d.attr("data-id"),f=d.attr("data-title"),g=d.attr("data-type"),h=b.$tabs_typetitle[g];return b.$listdata_obj={id:e,title:f,type:g,typeinfo:h},1!=b.options.isbackimgtxt?(b.options.backdatainfo(c,b.$listdata_obj),b.hide(),!1):void b.backimgtxtinfo(e,b.$listdata_obj)}))}};var e=a.fn[b];a.fn[b]=function(c){return this.each(function(){var e=a(this),f=e.data("selectPlugsData"),g=a.fn[b].pluginData[f],h="object"==typeof c&&c;g||(f=a.fn[b].pluginData.index++,a.fn[b].pluginData[f]=new d(this,h),e.data("selectPlugsData",f),g=a.fn[b].pluginData[f]),g.creatnav().initdata().show()})},a.fn[b].pluginData={index:0},a.fn[b].Constructor=b,a.fn[b].noConflict=function(){return a.fn[b]=e,this},a(document).ready(function(){a('[data-plug="'+b+'"]').each(function(){var c=a(this),d=this.dataset;a.fn[b].call(c,d)})}),d.version="1.0.0"}($);
!function(a){var b="selectClassfiy",c={host:"",backdatainfo:function(){}},d=function(b,d){this.$ele=a(b),this.options=a.extend({},c,d),this.init()};d.prototype={$platform:2,initDom:function(){return this.$listdata_obj="",this.$listdata_arr=[],this.$itemList=this.options.host+"/index.php/shangjia/commoncomponent/getcatslist?platform="+this.$platform,this},init:function(){return this.initDom().create(),this},create:function(){var b=this,c=[];c[0]='<div id="relaclassfiyModal" class="modal hide fade" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button><h3>选择关联分类</h3><span class="mlr05 red">提示：选择分类后可以拖拽排序</span></div><div class="modal-body"><div id="relateClassfiy" class="scrollbar fl"></div><div id="relatepreview" class="scrollbar fl"><ul></ul></div><div class="clearfix"></div></div><div class="modal-footer"><button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button> <button class="btn btn-primary classfiybtn">确定</button></div></div>';var d=a("body").find("#relaclassfiyModal").length;return 0>=d&&a(document.body).append(c[0]),b.$modalHTML=a("body").find("#relaclassfiyModal"),b.setDom(),this},setDom:function(){return this.$classifylist=this.$modalHTML.find("#relateClassfiy"),this.$previewlist=this.$modalHTML.find("#relatepreview"),this.$multiselectbtn=this.$modalHTML.find(".classfiybtn"),this},show:function(){return this.$modalHTML.modal("show"),this},hide:function(){return this.$modalHTML.modal("hide"),this},initdata:function(){return this.previewhtml(),this.itemlist(),this},itemlist:function(){var b=this;a.ajax({type:"POST",url:b.$itemList,data:{sale:b.options.sale},dataType:"json",async:!1,beforeSend:function(){b.$classifylist.html("<div class='dataloading'>加载中...</div>")},success:function(c){if("40001"==c.status)b.$classifylist.html("");else{var d="",e="",f=c.info;a.each(f,function(b,c){d+='<li data-cid="'+c.cid+'" data-id="'+c.id+'" data-url="'+c.cats_link+'" data-title="'+c.listname+'"><span>'+c.listname+"</span><code>"+c.prd_count+'</code><a href="javascript:void(0);" class="btn-link selrelalink">选择</a></li>',c.sub.length>0&&a.each(c.sub,function(a,b){d+='<li class="item_sub" data-cid="'+b.cid+'" data-id="'+b.id+'" data-url="'+b.cats_link+'" data-title="'+b.listname+'"><span>'+b.listname+"</span><code>"+b.prd_count+'</code><a href="javascript:void(0);" class="btn-link selrelalink">选择</a></li>'})}),e='<ul><li data-cid="0" data-id="0" data-url="'+c.indexurl+'" data-title="店铺首页链接"><span>店铺首页链接</span><a href="javascript:void(0);" class="btn-link selrelalink">选择</a></li>'+d+"</ul>",b.$classifylist.html(e);var g=b.$listdata_arr.length;if(g>0)for(var h=0;g>h;h++){var i=b.$listdata_arr[h].id;b.$classifylist.find("li").each(function(){var b=a(this).attr("data-id");i==b&&(a(this).addClass("btn-success"),a(this).find(".selrelalink").html("取消选择"))})}}}})},previewhtml:function(){var a=this,b="",c=a.$listdata_arr.length;if(c>0)for(var d=0;c>d;d++){var e=a.$listdata_arr[d].id,f=a.$listdata_arr[d].title,g=a.$listdata_arr[d].url;b+="<li data-id='"+e+"' data-url='"+g+"' data-title='"+f+"'><a href='javascript:void(0);' target='_blank'><span class='move_area'><i class='layer_icon_move' title='点击我可以拖拽排序哦'></i></span><span class='classfiyname'>"+f+"</span><div class='cancleprd'>X</div></a></li>"}a.$previewlist.find("ul").html(b)},checkedEle:function(b,c,d,e){if(b.hasClass("btn-success")){b.removeClass("btn-success"),b.find(".selrelalink").html("选择");var f=b.attr("data-id");a.removeItem(d,f,"id")}else 0==e?(b.addClass("btn-success"),b.find(".selrelalink").html("取消选择"),-1==jQuery.inArray(c,d)&&d.push(c)):d.length<e?(b.addClass("btn-success"),b.find(".selrelalink").html("取消选择"),-1==jQuery.inArray(c,d)&&d.push(c)):alert("您最多选择"+e+"个")},bindEvent:function(){var b=this,c=b.$ele;return b.$classifylist.undelegate(),b.$classifylist.delegate("li","click",function(){var c=a(this),d=c.attr("data-id"),e=c.attr("data-title"),f=c.attr("data-url");b.$listdata_obj={id:d,title:e,url:f},b.checkedEle(c,b.$listdata_obj,b.$listdata_arr,0),b.previewhtml()}),b.$previewlist.undelegate(),b.$previewlist.delegate("li .cancleprd","click",function(){var c=a(this),d=c.parents("li").attr("data-id");c.parents("li").remove(),a.removeItem(b.$listdata_arr,d,"id");var e=b.$listdata_arr.length;e>=0&&b.$classifylist.find("li.btn-success").each(function(){var c=a(this),d=c.attr("data-id");a(this).removeClass("btn-success");for(var f=0;e>f;f++){var g=b.$listdata_arr[f].id;d==g&&c.addClass("btn-success")}})}),b.$previewlist.find("ul").sortable({opacity:.8,cursor:"move",axis:"y",update:function(){b.$listdata_arr.splice(0,b.$listdata_arr.length),b.$previewlist.find("li").each(function(){var c=a(this),d=c.attr("data-id"),e=c.attr("data-title"),f=c.attr("data-url");b.$listdata_obj={id:d,title:e,url:f},b.$listdata_arr.push(b.$listdata_obj)})}}),a.isFunction(b.options.backdatainfo)&&(b.$multiselectbtn.unbind(),b.$multiselectbtn.bind("click",function(){var a=b.$listdata_arr.length;return a>0?(b.options.backdatainfo(c,b.$listdata_arr),void b.hide()):(alert("请选择关联分类"),!1)})),this}};var e=a.fn[b];a.fn[b]=function(c){return this.each(function(){var e=a(this),f=e.data("selectPlugsData"),g=a.fn[b].pluginData[f],h="object"==typeof c&&c;g||(f=a.fn[b].pluginData.index++,a.fn[b].pluginData[f]=new d(this,h),e.data("selectPlugsData",f),g=a.fn[b].pluginData[f]),g.initdata().bindEvent().show()})},a.fn[b].pluginData={index:0},a.fn[b].Constructor=b,a.fn[b].noConflict=function(){return a.fn[b]=e,this},a(document).ready(function(){a('[data-plug="'+b+'"]').each(function(){var c=a(this),d=this.dataset;a.fn[b].call(c,d)})}),d.version="1.0.0"}($);
!function(a){var b="selectwxvipcard",c={host:"",sid:"",type:"1",num:1,backdatainfo:function(){}},d=function(b,d){this.$ele=a(b),this.options=a.extend({},c,d),this.init()};d.prototype={initDom:function(){return this.$total="",this.$totalPage="",this.$curPage=1,this.$listdata_obj="",this.$listdata_arr=[],this.$getvipcardlist=this.options.host+"/index.php/shangjia/merbercard/chajianwxcardlist",this.$creatnewurl=this.options.host+"/index.php/shangjia/merbercard/creatwxvipcard",this},init:function(){var a=/^\d+$/.test(this.options.num);return a?(this.initDom().create(),this):(alert("请填写正确的选择数量的参数"),!1)},create:function(){var b=this,c=[];c[0]='<div id="MyVipcardModal" class="modal hide fade" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button><h3 class="fl">选择会员卡</h3><a href="'+b.$creatnewurl+'" class="btn btn-success fr" target="_blank" style="margin-right:20px;">新建会员卡</a><span class="btn fr refreshbtn">刷新</span><div class="clearfix"></div></div><div class="modal-body"><div class="scrollbar linkbox" id="myvipcardlist"></div><div class="prdpagecount"></div></div><div class="modal-footer"><button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button><button class="btn btn-primary vipcardsubmit">确定<span class="vipcard_num"></span></button></div></div>';var d=a("body").find("#MyVipcardModal").length;return 0>=d&&a(document.body).append(c[0]),b.$modalHTML=a("body").find("#MyVipcardModal"),b.setDom(),this},setDom:function(){return this.$refreshbtn=this.$modalHTML.find(".refreshbtn"),this.$contentlist=this.$modalHTML.find("#myvipcardlist"),this.$singleconfirmbtn=this.$modalHTML.find(".selvipcardbtn"),this.$multiselectbtn=this.$modalHTML.find(".vipcardsubmit"),this.$multiselectnum=this.$modalHTML.find(".vipcard_num"),this.$pagecontent=this.$modalHTML.find(".prdpagecount"),this.$pagebtn=this.$modalHTML.find(".prdpagecount span a"),this.$multiselectnum&&this.$multiselectnum.html(""),this},show:function(){return this.$modalHTML.modal("show"),this},hide:function(){return this.$modalHTML.modal("hide"),this},initdata:function(){return this.plugslistinit(this.$getvipcardlist),this},plugslistinit:function(a){this.$pagebtn.die("click"),this.getplugmainlist(1,a),this.ajaxpagemainlist(a)},getplugmainhtml:function(b){var c="",d='<table style="width:100%;"><tr><th>名称</th><th width="80">操作</th></tr>',e="",f=b.info;a.each(f,function(a,b){e+='<tr data-id="'+b.card_id+'"><td><span class="vipcard_title" title="'+b.cardtitle+'">'+b.cardtitle+'</span></td><td><a href="javascript:void(0);" class="btn-link selvipcardbtn" data-id="'+b.id+'" data-cardid="'+b.card_id+'" data-title="'+b.cardtitle+'">选择</a></td></tr>'});var g="</table>";return c=d+e+g},getplugmainlist:function(b,c){var d=this;a.ajax({type:"POST",url:c,data:{page:b,sid:d.options.sid,type:d.options.type},dataType:"json",beforeSend:function(){d.$contentlist.html("<div class='dataloading'>加载中...</div>"),d.$pagecontent.hide()},success:function(a){if("40001"==a.status)d.$contentlist.html("<div class='datawarn'>登陆超时，请<span class='btn-link' onclick='location.reload();'>刷新</span>页面重新登陆</div>"),d.$pagecontent.hide();else if(d.$contentlist.empty(),0==a.count)d.$contentlist.html("<div class='datawarn'>没有数据</div>"),d.$pagecontent.hide();else{a.countpage>1&&(d.$pagecontent.show(),d.$total=a.count,d.$totalPage=a.countpage,d.$curPage=b);var c=d.getplugmainhtml(a);d.$contentlist.html(c)}},complete:function(){var b=a.getPageBar(d.$curPage,d.$totalPage,d.$total);d.$pagecontent.html(b)},error:function(){d.$contentlist.html("<div class='datawarn'>数据加载失败</div>"),d.$pagecontent.hide()}})},ajaxpagemainlist:function(b){var c=this;c.$pagebtn.live("click",function(){var d=a(this).attr("rel");d&&c.getplugmainlist(d,b)})},bindEvent:function(){var b=this,c=b.$ele;return b.$refreshbtn.die(),b.$refreshbtn.live("click",function(){b.$multiselectnum&&b.$multiselectnum.html(""),b.initdata()}),a.isFunction(b.options.backdatainfo)&&(b.$singleconfirmbtn.die(),b.$singleconfirmbtn.live("click",function(){var d=a(this),e=d.attr("data-id"),f=d.attr("data-cardid"),g=d.attr("data-title");return b.$listdata_obj={id:e,cardid:f,title:g},1==b.options.num?(b.options.backdatainfo(c,b.$listdata_obj)!==!1&&b.hide(),!1):void 0})),this}};var e=a.fn[b];a.fn[b]=function(c){return this.each(function(){var e=a(this),f=e.data("selectPlugsData"),g=a.fn[b].pluginData[f],h="object"==typeof c&&c;g||(f=a.fn[b].pluginData.index++,a.fn[b].pluginData[f]=new d(this,h),e.data("selectPlugsData",f),g=a.fn[b].pluginData[f]),g.initdata().bindEvent().show()})},a.fn[b].pluginData={index:0},a.fn[b].Constructor=b,a.fn[b].noConflict=function(){return a.fn[b]=e,this},a(document).ready(function(){a('[data-plug="'+b+'"]').each(function(){var c=a(this),d=this.dataset;a.fn[b].call(c,d)})}),d.version="1.0.0"}($);
